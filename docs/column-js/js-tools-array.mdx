---
title: JS å·¥å…·å‡½æ•°é›†åˆ - Array ç¯‡
id: js-tools-array
sidebar_position: 1
toc_max_heading_level: 4
---

```mdx-code-block
import BrowserWindow from '@site/src/components/BrowserWindow';
import { Button, Image } from '@arco-design/web-react';
```

> æœ¬ç« èŠ‚è®°å½• JavaScript Array ç›¸å…³çš„ä¸€äº›å·¥å…·å‡½æ•°ï¼ŒåŒ…æ‹¬å¯¹ æ ‘ç»“æ„çš„è½¬æ¢, æ™®é€šæ•°ç»„çš„å¤„ç†ç­‰

<img src={require('/img/docs/js-tools/wallhaven.png').default} style={{ maxHeight: 360 }} />

## å–å€¼ & ç»Ÿè®¡

### è·å–éšæœºä¸€é¡¹å…ƒç´ 

è·å–æ™®é€šæ•°ç»„ä¸­çš„éšæœºä¸€é¡¹å…ƒç´ :

```tsx title="ä»£ç å®ç°"
const _randomArr = (arr: (string | number | boolean)[]) => {
  const len = arr.length;
  return arr[Math.floor(Math.random() * len)];
};
```

### ç»Ÿè®¡å…ƒç´ å‡ºç°çš„æ¬¡æ•°

ç»Ÿè®¡ä¸€ä¸ªå…ƒç´ åœ¨æ™®é€šæ•°ç»„ä¸­å‡ºç°çš„æ¬¡æ•°ï¼Œè¿”å›ä¸€ä¸ªå¯¹è±¡é›†åˆ:

```tsx title="ä»£ç å®ç°"
const _totalObj = (arr: (string | number)[]) => {
  return arr.reduce((pre, next) => {
    if (pre[next]) {
      pre[next]++;
    } else {
      pre[next] = 1;
    }
    return pre;
  }, {});
};
```

ç¤ºä¾‹:

```jsx live
function ExampleComponent(props) {
  const array = ['æ™®å´ä¿¡ ğŸ¤–', 'æ™®å´ä¿¡ ğŸ¤–', 'sunny ğŸŒ', 'æ™®å´ä¿¡ ğŸ¤–', 'sunny ğŸŒ', 'dino ğŸ¦–'];

  const [value, setValue] = useState({});

  const handleClick = () => {
    const result = _totalObj(array);
    // setValue(JSON.stringify(result, null, '\t')); // æ ¼å¼åŒ– jsonï¼Œç¼©è¿›ä¸€ä¸ª tab
    // setValue(JSON.stringify(result, null, 4)); // ç¼©è¿› 4 ä¸ªç©ºæ ¼ï¼ˆå®é™…åªæœ‰ä¸€ä¸ªç©ºæ ¼ï¼‰
    setValue(result);
  };

  return (
    <Space direction='vertical'>
      <Button type='primary' onClick={handleClick}>
        ç‚¹å‡»æ˜¾ç¤ºç»“æœ
      </Button>
      {/* react-json-view ç»„ä»¶ï¼Œæ ¼å¼åŒ–æ¸²æŸ“ json å¯¹è±¡ */}
      <ReactJsonView src={value} />
    </Space>
  );
}
```

## æ ‘ç»“æ„è½¬æ¢ & æŸ¥æ‰¾

### æ•°ç»„è½¬æ¢ä¸ºæ ‘ç»“æ„

æœ‰æ—¶å€™ä¼šé‡åˆ°å«æœ‰å±‚çº§ç»“æ„çš„æ•°ç»„ï¼Œè¿™æ—¶éœ€è¦é€šè¿‡æ·±åº¦ä¼˜å…ˆéå†çš„æ–¹å¼å°†å…¶è½¬æ¢ä¸ºæ ‘ç»“æ„ï¼ˆéœ€è¦æ¯ä¸€æ¡æ•°æ®å«æœ‰è‡ªèº«åŠçˆ¶çº§çš„å”¯ä¸€å€¼ï¼Œå¦‚ `id` å’Œ `parentId`ï¼‰:

```ts title="æ•°æ®ç›¸å…³çš„ç±»å‹(è‡ªå®šä¹‰)"
interface TreeDataTypes {
  pid?: number; // çˆ¶èŠ‚ç‚¹ id
  area_code: number; // è‡ªèº« id
  children?: TreeDataTypes[]; // å­èŠ‚ç‚¹ list
  [key: string]: any;
}
```

```jsx title="ä»£ç å®ç° - å£¹"
const _dataToTree = (arr: TreeDataTypes[]) => {
  // å…ˆå°†æ•°ç»„è½¬æ¢æˆä»¥ area_code ä¸º key å€¼çš„å¯¹è±¡æ ¼å¼
  const node = arr.reduce((prev, cur) => {
    prev[cur['area_code']] = cur;
    return prev;
  }, {});

  return arr.reduce((prev, cur) => {
    const parentId = cur?.pid;
    // å¯¹è±¡çš„æµ…æ‹·è´ï¼Œå¼•ç”¨å…³ç³»å­˜åœ¨ï¼Œåœ¨åé¢å¤„ç† parent çš„æ—¶å€™ä¹Ÿä¼šå¯¼è‡´ cur çš„æ”¹å˜ï¼Œè¾¾åˆ°é€’å½’çš„æ•ˆæœ
    const parentObj = node?.[parentId];
    // å¦‚æœçˆ¶å¯¹è±¡å­˜åœ¨ï¼Œå°±å°† cur æ”¾åˆ°çˆ¶å¯¹è±¡çš„ children ä¸­
    if (parentObj) {
      parentObj.children ? parentObj.children.push(cur) : (parentObj.children = [cur]);
    }
    // æ²¡æœ‰çˆ¶å¯¹è±¡ï¼Œåˆ™æ­¤ cur ä¸ºæ ‘çš„æ ¹èŠ‚ç‚¹
    !parentId && prev.push(cur);
    return prev;
  }, []);
};
```

```jsx title="ä»£ç å®ç° - è´°"
const _dataToTree = (arr: TreeDataTypes[], id = 0) => {
  // ä¸ ä»£ç å®ç°-å£¹ ç›¸ä¼¼ï¼Œé€šè¿‡è½¬æ¢æˆå¯¹è±¡å–å€¼æ˜ å°„çš„å½¢å¼ï¼Œä»è€Œé™ä½æ—¶é—´å¤æ‚åº¦
  const node = arr.reduce((prev, cur) => {
    prev[cur['area_code']] = cur;
    cur.children = [];
    return prev;
  }, {});

  return arr.filter((item) => {
    node[item?.pid] && node[item?.pid].children.push(item);
    return !item?.pid;
  });
};
```

```jsx title="ä»£ç å®ç° - å"
const _dataToTree = (arr: TreeDataTypes[], id = 0) => {
  // é’ˆå¯¹ä¸€çº§æ•°ç»„æ²¡æœ‰ pid çš„æƒ…å†µï¼Œå°†å…¶ pid è®¾ç½®ä¸º 0
  if (!id) {
    arr.forEach((item) => {
      if (!item?.pid) item.pid = 0;
    });
  }

  return arr
    .filter((item) => item?.pid === id)
    .map((item) => ({ ...item, children: _dataToTree(arr, item.area_code) }));
};
```

ç¤ºä¾‹:

```jsx live
function ExampleComponent(props) {
  const array = [
    { area_name: 'æµ™æ±Ÿçœ', area_code: 330000, levle: 0 },
    { area_name: 'æ­å·å¸‚', area_code: 330100, levle: 1, pid: 330000 },
    { area_name: 'ä½™æ­åŒº', area_code: 330110, levle: 2, pid: 330100 },
    { area_name: 'å†…è’™å¤è‡ªæ²»åŒº', area_code: 150000, levle: 0 },
    { area_name: 'å‘¼å’Œæµ©ç‰¹å¸‚', area_code: 150100, levle: 1, pid: 150000 },
    { area_name: 'åŒ…å¤´å¸‚', area_code: 150200, levle: 1, pid: 150000 },
    { area_name: 'é’å±±åŒº', area_code: 150204, levle: 2, pid: 150200 },
    { area_name: 'åœŸé»˜ç‰¹å³æ——', area_code: 150221, levle: 2, pid: 150200 },
  ];

  const [value, setValue] = useState({});

  return (
    <Space direction='vertical'>
      <Button type='primary' onClick={() => setValue(_dataToTree(array))}>
        ç‚¹å‡»æ˜¾ç¤ºç»“æœ
      </Button>
      <ReactJsonView src={value} collapsed={2} enableClipboard />
    </Space>
  );
}
```

### æ›´æ”¹æ ‘ç»“æ„çš„å±æ€§å

æœ‰æ—¶åœ¨ä½¿ç”¨ UI æ¡†æ¶ä¸­çš„ç»„ä»¶æ—¶ï¼Œå¯èƒ½ä¼šç¢°åˆ°ç»„ä»¶è¦çš„æ•°æ®æ ¼å¼å’Œæ‹¿åˆ°çš„æ•°æ®æ ¼å¼ä¸ä¸€è‡´ï¼Œè¿™æ—¶å°±éœ€è¦å°†æ‹¿åˆ°çš„æ•°æ®è¿›è¡Œè½¬æ¢ï¼Œæ›´æ”¹æˆ–æ·»åŠ ç»„ä»¶æ‰€éœ€çš„æ ¼å¼;

```ts title="æ•°æ®ç›¸å…³çš„ç±»å‹(è‡ªå®šä¹‰)"
interface TreeDataTypes {
  code: number;
  name: string;
  childList?: TreeDataTypes[];
  [key: string]: any;
}
```

```js title="ä»£ç å®ç° - å£¹"
// é€’å½’æ·»åŠ å±æ€§
const _updateTreeKey = (arr: UpdateTreeDataTypes[]) => {
  return arr.map((item) => {
    const isHasChild = Array.isArray(item?.childList);
    return {
      ...item,
      key: item.code,
      label: item.name,
      ...(isHasChild && { children: _updateTreeKey(item?.childList) }),
    };
  });
};

// é€’å½’æ›¿æ¢å±æ€§
const _updateTreeKey = (arr: UpdateTreeDataTypes[]) => {
  return arr.map((item) => {
    const isHasChild = Array.isArray(item?.childList);
    const newItem = {
      ...item,
      key: item.code,
      label: item.name,
      ...(isHasChild && { children: _updateTreeKey(item?.childList) }),
    };
    delete newItem.name;
    delete newItem.code;
    delete newItem?.childList;
    return newItem;
  });
};
```

```jsx title="ä»£ç å®ç° - è´°"
// æ›¿æ¢å±æ€§ï¼Œè½¬æ¢æˆå­—ç¬¦ä¸²åå†è¿›è¡Œæ›¿æ¢ï¼Œç®€å•ç²—æš´
const _updateTreeKey = (arr: UpdateTreeDataTypes[]) => {
  const str = JSON.stringify(arr)
    .replace(/"code"/g, '"key"') // æ›¿æ¢çš„å†…å®¹ä¸€å®šè¦åŠ å¼•å·
    .replace(/"name"/g, '"label"')
    .replace(/"childList"/g, '"children"');

  return JSON.parse(str);
};
```

```jsx live
function ExampleComponent(props) {
  const array = [
    {
      name: 'ç»„ä»¶',
      code: 'component',
      type: 'menu',
      childList: [
        {
          name: 'é€šç”¨ç»„ä»¶',
          code: 'common_component',
          type: 'group-menu',
          childList: [
            { name: 'æŒ‰é’® Button', code: 'button', type: 'child-menu' },
            { name: 'å›¾æ ‡ Icon', code: 'icon', type: 'child-menu' },
          ],
        },
      ],
    },
  ];

  const [value, setValue] = useState({});

  return (
    <Space direction='vertical'>
      <Button type='primary' onClick={() => setValue(_updateTreeKey(array))}>
        ç‚¹å‡»æ˜¾ç¤ºç»“æœ
      </Button>
      <ReactJsonView src={value} collapsed={2} enableClipboard />
    </Space>
  );
}
```

### æŸ¥æ‰¾æ ‘ç»“æ„çš„èŠ‚ç‚¹

- æ ¹æ®ä»»æ„èŠ‚ç‚¹çš„ **å”¯ä¸€å€¼**ï¼Œé€’å½’æŸ¥æ‰¾æ ‘ç»“æ„ä¸­çš„è¯¥èŠ‚ç‚¹ï¼Œè¿”å›è¯¥èŠ‚ç‚¹çš„å®Œæ•´æ•°æ®;

```jsx title="ä»£ç å®ç°"
const _findTreeNode = (arr: any[]) => {};
```

- æ ¹æ®ä»»æ„èŠ‚ç‚¹çš„ **å”¯ä¸€å€¼**ï¼Œé€’å½’æŸ¥æ‰¾æ ‘ç»“æ„ä¸­è¯¥èŠ‚ç‚¹ä¸‹çš„ **æœ€åä¸€çº§èŠ‚ç‚¹**;

- é€’å½’æŸ¥æ‰¾æ ‘ç»“æ„ä¸­ **ç¬¬ä¸€ä¸ªå­èŠ‚ç‚¹** ä¸‹çš„ **æœ€åä¸€çº§èŠ‚ç‚¹**;

- é€’å½’æŸ¥æ‰¾æ ‘ç»“æ„ä¸­ **ç¬¬ä¸€ä¸ªå­èŠ‚ç‚¹** ä¸‹çš„ **æœ€åä¸€çº§èŠ‚ç‚¹**;

```jsx live
function ExampleComponent(props) {
  const array = [
    {
      name: 'ğŸ“‚ /',
      code: 'root',
      key: '1',
      childList: [
        {
          name: 'ğŸ“‚ src',
          code: 'src',
          key: '1-1',
          children: [
            { name: 'ğŸ“‚ components', code: 'components', key: '1-1-1' },
            { name: 'ğŸ“ƒ typings.d.ts', code: 'typings-ts', key: '1-1-2' },
          ],
        },
      ],
    },
  ];

  const [value, setValue] = useState({});

  return (
    <Space direction='vertical'>
      <Input placeholder='è¾“å…¥ä»»æ„ code è¿›è¡ŒæŸ¥æ‰¾' />
      <Button type='primary' onClick={() => setValue(_updateTreeKey(array))}>
        ç‚¹å‡»æ˜¾ç¤ºç»“æœ
      </Button>
      <ReactJsonView src={value} collapsed={2} enableClipboard />
    </Space>
  );
}
```
