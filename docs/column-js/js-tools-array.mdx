---
title: JS å·¥å…·å‡½æ•° - Array ç¯‡
id: js-tools-array
sidebar_position: 1
toc_max_heading_level: 4
---

```mdx-code-block
import { Image } from '@arco-design/web-react';
```

> æœ¬ç« èŠ‚è®°å½• JavaScript `Array` ç›¸å…³çš„ä¸€äº›å·¥å…·å‡½æ•°ï¼ŒåŒ…æ‹¬æ•°ç»„çš„å»é‡ï¼Œåˆ†ç»„ï¼Œè¿‡æ»¤ç­‰æ–¹æ³•

<img src={require('./img/js-tools-array/wallhaven.jpeg').default} style={{ maxHeight: 360 }} />

## å–å€¼ & ç»Ÿè®¡

### è·å–éšæœºä¸€é¡¹å…ƒç´ 

è·å–æ™®é€šæ•°ç»„ä¸­çš„éšæœºä¸€é¡¹å…ƒç´ :

```tsx title="ä»£ç å®ç°"
export const _randomArr = (arr: (string | number | boolean)[]) => {
  const len = arr.length;
  return arr[Math.floor(Math.random() * len)];
};
```

### ç»Ÿè®¡å…ƒç´ å‡ºç°çš„æ¬¡æ•°

ç»Ÿè®¡ä¸€ä¸ªå…ƒç´ åœ¨æ™®é€šæ•°ç»„ä¸­å‡ºç°çš„æ¬¡æ•°ï¼Œè¿”å›ä¸€ä¸ªå¯¹è±¡é›†åˆ:

```tsx title="ä»£ç å®ç°"
export const _totalObj = (arr: (string | number)[]) => {
  return arr.reduce((pre, next) => {
    if (pre[next]) {
      pre[next]++;
    } else {
      pre[next] = 1;
    }
    return pre;
  }, {});
};
```

ç¤ºä¾‹:

```jsx live
function ExampleComponent(props) {
  const array = ['æ™®å´ä¿¡ ğŸ¤–', 'æ™®å´ä¿¡ ğŸ¤–', 'sunny ğŸŒ', 'æ™®å´ä¿¡ ğŸ¤–', 'sunny ğŸŒ', 'dino ğŸ¦–'];

  const [value, setValue] = useState({});

  return <ResultButton results={value} onClick={() => setValue(_totalObj(array))} />;
}
```

## è¿‡æ»¤

### æ•°ç»„æ ¹æ®æŒ‡å®šå€¼è¿›è¡Œè¿‡æ»¤

å¯¹è±¡æ•°ç»„æ ¹æ®å¦ä¸€ä¸ªæ•°ç»„ä¸­çš„å€¼è¿›è¡ŒåŒ¹é…å¹¶è¿‡æ»¤ï¼Œåªä¿ç•™æ²¡æœ‰åŒ¹é…åˆ°çš„æ•°æ®;

```jsx title="ä»£ç å®ç°"
export const _dataFilter = (arr: any[], codeList: string[]) => {
  return arr.filter((item) => !codeList.includes(item?.code));
};
```

ç¤ºä¾‹:

```jsx live
function ExampleComponent(props) {
  const array = [
    { name: 'å¾®ä¿¡', code: 'whect' },
    { name: 'BOSSç›´è˜', code: 'boss' },
    { name: 'é’‰é’‰', code: 'dingtalk' },
    { name: 'äº¬ä¸œé‡‘è', code: 'jingdong' },
  ];
  const codeList = [
    { name: 'BOSSç›´è˜', code: 'boss' },
    { name: 'äº¬ä¸œé‡‘è', code: 'jingdong' },
  ];

  const [value, setValue] = useState();
  const codeMap = codeList.map((item) => item.code);

  return <ResultButton results={value} onClick={() => setValue(_dataFilter(array, codeMap))} />;
}
```

## å»é‡

### æ™®é€šæ•°ç»„çš„å»é‡

```jsx title="ä»£ç å®ç° - å£¹ ğŸ"
// ä½¿ç”¨ new Set() + è§£æ„ çš„æ–¹å¼è¿›è¡Œå»é‡
export const _unique = (arr: any[]) => {
  return [...new Set(arr)];
  // or
  return Array.from(new Set(arr));
};
```

```jsx title="ä»£ç å®ç° - è´° ğŸ"
// ä½¿ç”¨ new Map() + Array.filter çš„æ–¹æ³•ï¼Œåˆ©ç”¨ Map() çš„é”®å€¼å¯¹å…·æœ‰å”¯ä¸€æ€§çš„ç‰¹ç‚¹è¿›è¡Œå»é‡
export const _unique = (arr: any[]) => {
  const map = new Map();
  return arr.filter((item) => !map.has(item) && map.set(item, true));
};
```

```jsx title="ä»£ç å®ç° - å"
// ä½¿ç”¨ Array.includes æˆ– Array.indexof çš„æ–¹å¼è¿›è¡Œå»é‡
export const _unique = (arr: any[]) => {
  const newArray = [];
  arr.forEach((item) => {
    if (!newArray.includes(item)) newArray.push(item);
    // or
    if (newArray.indexOf(item) === -1) newArray.push(item); // ğŸ“¢ è¯¥æ–¹æ³•å¯¹å»é‡ NaN æ— æ•ˆï¼Œå› ä¸º [NaN].indexOf(NaN) === -1
  });
  return newArray;
};
```

```jsx title="ä»£ç å®ç° - è‚†"
// ä½¿ç”¨ Array.filter + Array.indexOf çš„æ–¹å¼è¿›è¡Œå»é‡ï¼ŒåŸç†ä¸º indexOf è¿”å›çš„ç»“æœæ˜¯è¯¥å…ƒç´ (ç¬¬ä¸€ä¸ª)åœ¨æ•°ç»„ä¸­çš„ç´¢å¼•
export const _unique = (arr: any[]) => {
  return arr.filter((item, index) => arr.indexOf(item) === index); // ğŸ“¢ è¯¥æ–¹æ³•ä¼šå°†æ‰€æœ‰çš„ NaN éƒ½è¿‡æ»¤æ‰
};
```

```jsx title="ä»£ç å®ç° - ä¼"
// ä½¿ç”¨ Array.filter + Object.hasOwnProperty çš„æ–¹å¼è¿›è¡Œå»é‡ï¼ŒåŸç†ä¸ºå¯¹è±¡çš„é”®å€¼å¯¹ä¸å¯é‡å¤
export const _unique = (arr: any[]) => {
  // ğŸ“¢ Object.hasOwnProperty() æ–¹æ³•è¿”å›ä¸€ä¸ª booleanï¼Œç”¨æ¥æŸ¥æ‰¾è¯¥å¯¹è±¡ä¸­æ˜¯å¦å­˜åœ¨æŸæŒ‡å®šå±æ€§
  const map = {};
  return arr.filter((item) =>
    map.hasOwnProperty(typeof item + item) ? false : (map[typeof item + item] = true)
  );
};
```

```jsx title="ä»£ç å®ç° - é™† ğŸ"
// ä½¿ç”¨ Array.reduce + Array.includes çš„æ–¹å¼è¿›è¡Œå»é‡
export const _unique = (arr: any[]) => {
  return arr.reduce((prev, cur) => {
    return prev.includes(cur) ? prev : prev.concat(cur); // concat æ‹¼æ¥
    // or
    return prev.includes(cur) ? prev : [...prev, cur]; // è§£æ„ æ‹¼æ¥
  }, []);
};
```

```jsx title="ä»£ç å®ç° - æŸ’"
// ä½¿ç”¨ Array.sort æ’åºçš„æ–¹æ³•ï¼ŒåŸç†æ˜¯å°†æ•°ç»„ä¸­é‡å¤çš„å…ƒç´ æ’åˆ—åœ¨ä¸€èµ·ï¼Œå†è¿›è¡Œå»é‡
export const _unique = (arr: any[]) => {
  const newArray = [];
  arr.sort().forEach((item) => {
    if (item !== newArray[newArray.length - 1]) newArray.push(item); // ğŸ“¢ è¯¥æ–¹æ³•å¯¹å»é‡ NaN æ— æ•ˆï¼Œå› ä¸º NaN !== NaN
  });
  return newArray;
};
```

ç¤ºä¾‹:

```jsx live
function ExampleComponent(props) {
  const array = [25, 'ğŸ˜„', 25, 'ğŸ˜„', null, NaN, null, NaN, '2022-02-25', '2022-02-25', 'China ğŸ‡¨ğŸ‡³'];

  const [value, setValue] = useState();

  return <ResultButton results={value} onClick={() => setValue(_unique(array))} />;
}
```

### å¯¹è±¡æ•°ç»„çš„å»é‡

```jsx title="ä»£ç å®ç° - å£¹"
// æ ¹æ®æŸå­—æ®µ(prop)ï¼Œä½¿ç”¨ æ™®é€šå¾ªç¯ çš„æ–¹å¼å»é‡
export const _uniqueObj = (arr: any[], prop: string) => {
  const obj = {};
  const result = [];
  arr.forEach((item) => {
    if (!obj[item[prop]]) {
      result.push(item);
      obj[item[prop]] = true;
    }
  });
  return result;
};
```

```jsx title="ä»£ç å®ç° - è´° ğŸ"
// æ ¹æ®æŸå­—æ®µ(prop)ï¼Œä½¿ç”¨ Array.reduce çš„æ–¹å¼å»é‡
export const _uniqueObj = (arr: any[], prop: string) => {
  const obj = {};
  return arr.reduce((prev, cur) => {
    obj[cur[prop]] ? '' : (obj[cur[prop]] = true && prev.push(cur));
    return prev;
  }, []);
};
```

```jsx title="ä»£ç å®ç° - å"
// æ ¹æ®æŸå­—æ®µ(prop)ï¼Œä½¿ç”¨ Array.filter + Array.findIndex çš„æ–¹å¼å»é‡
export const _uniqueObj = (arr: any[], prop: string) => {
  return arr.filter((item, index, self) => {
    return self.findIndex((el) => el[prop] === item[prop]) === index;
  });
};
```

ç¤ºä¾‹:

```jsx live
function ExampleComponent(props) {
  const array = [
    { area_id: '25', area_name: 'æ­¦æ±‰' },
    { area_id: '30', area_name: 'é•¿æ²™' },
    { area_id: '36', area_name: 'å—äº¬' },
    { area_id: '30', area_name: 'é•¿æ²™' },
    { area_id: '25', area_name: 'æ­¦æ±‰' },
  ];

  const [value, setValue] = useState();

  return <ResultButton results={value} onClick={() => setValue(_uniqueObj(array, 'area_id'))} />;
}
```

## åˆ†ç»„

### æ•°æ®çš„åˆ†ç»„(ä¸€å¯¹å¤š)

æ ¹æ®æ•°æ®ä¸­çš„æŸå­—æ®µï¼Œå¯¹æ•°æ®è¿›è¡Œåˆ†ç»„ï¼Œ**å¤šæ¡æ•°æ®åªå¯¹åº”ä¸€ä¸ªåˆ†ç»„**ï¼Œè¿”å›ä¸€ä¸ª **å¯¹è±¡ / å¯¹è±¡æ•°ç»„**ï¼ŒåŒ **lodash** å·¥å…·åº“ä¸­çš„ `_groupBy` æ–¹æ³•;

```jsx title="ä»£ç å®ç° - å£¹: è¿”å›ä¸€ä¸ªå¯¹è±¡"
// æ ¹æ®æŒ‡å®šå­—æ®µï¼Œä½¿ç”¨ æ™®é€šå¾ªç¯ çš„æ–¹å¼åˆ†ç»„ï¼Œè¿”å›ä¸€ä¸ªå¯¹è±¡
export const _groupByObj = (arr: any[], prop: string) => {
  const groups = {};
  arr.forEach((item) => {
    const value = item[prop];
    groups[value] = groups[value] || [];
    groups[value].push(item);
  });
  return groups;
};
```

```jsx title="ä»£ç å®ç° - è´°: è¿”å›ä¸€ä¸ªå¯¹è±¡ ğŸ"
// æ ¹æ®æŒ‡å®šå­—æ®µï¼Œä½¿ç”¨ Array.reduce çš„æ–¹å¼åˆ†ç»„ï¼Œè¿”å›ä¸€ä¸ªå¯¹è±¡
export const _groupByObj = (arr: any[], prop: string) => {
  return arr.reduce((prev, cur) => {
    (prev[cur[prop]] = prev[cur[prop]] || []).push(cur);
    return prev;
  }, {});
};
```

```jsx title="ä»£ç å®ç° - å: è¿”å›ä¸€ä¸ªå¯¹è±¡æ•°ç»„"
export const _groupByArray = (arr: any[]) => {
  const dest = [];
  const groups = {};
  arr.forEach((item) => {
    const { groupName, groupCode } = item;
    if (!groups[groupCode]) {
      groups[groupCode] = { groupName, groupCode, children: [] };
      dest.push(groups[groupCode]);
    }
    groups[groupCode].children.push(item);
  });
  return dest;
};
```

ç¤ºä¾‹:

```jsx live
function ExampleComponent(props) {
  const array = [
    { code: 'WeChat', name: 'å¾®ä¿¡', groupName: 'ç¤¾äº¤', groupCode: 'chat' },
    { code: 'dingding', name: 'é’‰é’‰', groupName: 'ç¤¾äº¤', groupCode: 'chat' },
    { code: 'majiang', name: 'æ¬¢ä¹éº»å°†', groupName: 'æ¸¸æˆ', groupCode: 'game' },
    { code: 'lolm', name: 'è‹±é›„è”ç›Ÿæ‰‹æ¸¸', groupName: 'æ¸¸æˆ', groupCode: 'game' },
    { code: 'qq', name: 'QQ ğŸ§', groupName: 'ç¤¾äº¤', groupCode: 'chat' },
    { code: 'taobao', name: 'æ·˜å®', groupName: 'è´­ç‰©', groupCode: 'shop' },
    { code: 'jingdong', name: 'äº¬ä¸œ', groupName: 'è´­ç‰©', groupCode: 'shop' },
  ];

  const [value, setValue] = useState();

  return (
    <ResultButton
      results={value}
      buttonGroup={[
        { text: 'æ˜¾ç¤ºç»“æœ(å¯¹è±¡)', onClick: () => setValue(_groupByObj(array, 'groupName')) },
        { text: 'æ˜¾ç¤ºç»“æœ(å¯¹è±¡æ•°ç»„)', onClick: () => setValue(_groupByArray(array)) },
      ]}
    />
  );
}
```

### æ•°æ®çš„åˆ†ç»„(å¤šå¯¹å¤š)

æ ¹æ®æ•°æ®ä¸­çš„æŸå­—æ®µï¼Œå¯¹æ•°æ®è¿›è¡Œåˆ†ç»„ï¼Œ**ä¸€æ¡æ•°æ®å¯å¯¹åº”å¤šä¸ªä¸åŒçš„åˆ†ç»„**ï¼Œè¿”å›ä¸€ä¸ª **å¯¹è±¡ / å¯¹è±¡æ•°ç»„**ï¼Œå®è´¨ä¸Šå°±æ˜¯åœ¨ ä¸€å¯¹å¤šåˆ†ç»„ çš„æ–¹æ³•ä¸­å†å¤šå¾ªç¯ä¸€å±‚;

```jsx title="ä»£ç å®ç° - å£¹: è¿”å›ä¸€ä¸ªå¯¹è±¡"
export const _groupByManyObj = (arr: any[]) => {
  return arr.reduce((prev, item) => {
    item['groupList'].forEach((each) => {
      (prev[each[prop]] = prev[each[prop]] || []).push(item);
    });
    return prev;
  }, {});
};
```

```jsx title="ä»£ç å®ç° - è´°: è¿”å›ä¸€ä¸ªå¯¹è±¡æ•°ç»„"
export const _groupByManyArray = (arr: any[]) => {
  const dest = [];
  const groups = {};
  arr.forEach((item) => {
    item['groupList'].forEach(({ groupName, groupCode }) => {
      if (!groups[groupCode]) {
        groups[groupCode] = { groupName, groupCode, children: [] };
        dest.push(groups[groupCode]);
      }
      groups[groupCode].children.push(item);
    });
  });
  return dest;
};
```

ç¤ºä¾‹:

```jsx live
function ExampleComponent(props) {
  const array = [
    {
      code: 'WeChat',
      name: 'å¾®ä¿¡',
      groupList: [
        { groupName: 'ç¤¾äº¤', groupCode: 'chat' },
        { groupName: 'çƒ­é—¨è½¯ä»¶', groupCode: 'hot' },
        { groupName: 'ç²¾é€‰è½¯ä»¶', groupCode: 'selected' },
      ],
    },
    {
      code: 'dingding',
      name: 'é’‰é’‰',
      groupList: [
        { groupName: 'ç¤¾äº¤', groupCode: 'chat' },
        { groupName: 'çƒ­é—¨è½¯ä»¶', groupCode: 'hot' },
      ],
    },
    {
      code: 'taobao',
      name: 'æ·˜å®',
      groupList: [
        { groupName: 'è´­ç‰©', groupCode: 'shop' },
        { groupName: 'çƒ­é—¨è½¯ä»¶', groupCode: 'hot' },
      ],
    },
    {
      code: 'jingdong',
      name: 'äº¬ä¸œ',
      groupList: [
        { groupName: 'è´­ç‰©', groupCode: 'shop' },
        { groupName: 'çƒ­é—¨è½¯ä»¶', groupCode: 'hot' },
        { groupName: 'ç²¾é€‰è½¯ä»¶', groupCode: 'selected' },
      ],
    },
  ];

  const [value, setValue] = useState();

  return (
    <ResultButton
      results={value}
      buttonGroup={[
        { text: 'æ˜¾ç¤ºç»“æœ(å¯¹è±¡)', onClick: () => setValue(_groupByManyObj(array, 'groupName')) },
        { text: 'æ˜¾ç¤ºç»“æœ(å¯¹è±¡æ•°ç»„)', onClick: () => setValue(_groupByManyArray(array)) },
      ]}
    />
  );
}
```

## æ‹·è´

:::tip ä¸ºä»€ä¹ˆè¦è¿›è¡Œæ‹·è´ï¼Ÿ

- **åŸå§‹(åŸºç¡€)æ•°æ®ç±»å‹** å­˜å‚¨åœ¨ `æ ˆ(ç³»ç»Ÿè‡ªåŠ¨åˆ†é…)` ä¸­ï¼Œå­˜å‚¨çš„æ˜¯ `å€¼`;
- **å¼•ç”¨(å¤æ‚)æ•°æ®ç±»å‹** å­˜å‚¨åœ¨ `å †(äººä¸ºç”³è¯·å¼€è¾Ÿ)` ä¸­ï¼Œ`æ ˆ` ä¸­å­˜å‚¨çš„æ˜¯ **åœ°å€**ï¼Œæ˜¯æŒ‡å‘ `å †` çš„å¼•ç”¨åœ°å€ï¼›`å †` ä¸­å­˜å‚¨çš„æ˜¯ **è¯¥æ•°æ®çš„å±æ€§æˆ–å€¼**;
- ç”±äº JavaScript **ä¸å…è®¸ç›´æ¥è®¿é—®** å­˜å‚¨åœ¨ `å †` å†…å­˜ä¸­çš„æ•°æ®ï¼Œæ‰€ä»¥åœ¨è®¿é—®æ—¶ï¼Œå®é™…ä¸Šè®¿é—®çš„æ˜¯ `æ ˆ` ä¸­çš„å¼•ç”¨åœ°å€ï¼Œæ ¹æ®è¿™ä¸ªåœ°å€è·å–æˆ–ä¿®æ”¹ `å †` ä¸­çš„å€¼;
- ç»¼ä¸Šæ‰€è¿°ï¼Œè¿™æ ·å°±ä¼šå‡ºç°ä¸€ä¸ªå¸¸è§çš„é—®é¢˜: å½“ **å¤åˆ¶** ä¸€ä¸ªå¼•ç”¨ç±»å‹çš„æ•°æ®æ—¶ï¼Œåªè¦è¿›è¡Œä¿®æ”¹ï¼Œå°±ä¼šå½±å“åˆ°åŸæœ‰çš„æ•°æ®ï¼Œå› æ­¤ä¼šæœ‰ **æµ…æ‹·è´** å’Œ **æ·±æ‹·è´** çš„æ¦‚å¿µ;

:::

### æ™®é€šæ•°æ®çš„æµ…æ‹·è´

- æ•°æ®è¿›è¡Œæµ…æ‹·è´æ—¶ï¼Œå¯ä»¥é€šè¿‡æ›´æ”¹å®ƒçš„å¼•ç”¨åœ°å€æ¥å®ç°ï¼Œä½†æ˜¯åªèƒ½æ›´æ”¹ **ç¬¬ä¸€å±‚** æ•°æ®(ä¸€ç»´æ•°æ®)ï¼Œå¤æ‚çš„æˆ–è€…æœ‰å±‚çº§åµŒå¥—çš„æ•°æ®æ˜¯æ— æ³•æ‹·è´åˆ°çš„;
- è¯¥æ‹·è´é€šè¿‡ JavaScript ä¸€äº›è‡ªå¸¦çš„æ–¹æ³•å³å¯å®ç°;

```jsx title="ä»£ç å®ç° - å¯¹è±¡çš„æµ…æ‹·è´"
export const _cloneByObj = (obj: { [key: string]: any }) => {
  // 1ï¸âƒ£ é€šè¿‡ Object.assign() å®ç°
  return Object.assign({}, obj);

  // 2ï¸âƒ£ é€šè¿‡ æ‹“å±•è¿ç®—ç¬¦ å®ç°
  return { ...obj };

  // 3ï¸âƒ£ é€šè¿‡ for...in å¾ªç¯å®ç°
  const newObj = {};
  for (const key in obj) {
    newObj[key] = obj[key];
  }
  return newObj;
};
```

```jsx title="ä»£ç å®ç° - æ•°ç»„çš„æµ…æ‹·è´"
export const _cloneByArray = (arr: any[]) => {
  // 1ï¸âƒ£ é€šè¿‡ Array.slice() å®ç°
  return arr.slice();

  // 2ï¸âƒ£ é€šè¿‡ Array.concat() å®ç°
  return arr.concat();

  // 3ï¸âƒ£ é€šè¿‡ Array.from() å®ç°
  return Array.from(arr);

  // 4ï¸âƒ£ é€šè¿‡ æ‹“å±•è¿ç®—ç¬¦ å®ç°
  return [...arr];
};
```

ç¤ºä¾‹:

```jsx live
function ExampleComponent(props) {
  const arr = [25, { name: 'dino' }];
  const newArr = _cloneByArray(arr); // æ‹·è´
  newArr.push('ğŸ˜¡');
  newArr[1].name = 'å‹ºå­ ğŸ¶'; // ä¼šå½±å“åŸæ•°æ®

  const obj = { name: 'dino', age: 25, hometown: { city: 'åŒ…å¤´' } };
  const newObj = _cloneByObj(obj); // æ‹·è´
  newObj.name = 'å‹ºå­ ğŸ¶';
  newObj.hometown.city = 'æ­å·'; // ä¼šå½±å“åŸæ•°æ®

  const [value, setValue] = useState();

  return (
    <ResultButton
      results={value}
      buttonGroup={[
        { text: 'æ˜¾ç¤ºç»“æœ(æ•°ç»„çš„æµ…æ‹·è´)', onClick: () => setValue({ arr, newArr }) },
        { text: 'æ˜¾ç¤ºç»“æœ(å¯¹è±¡çš„æµ…æ‹·è´)', onClick: () => setValue({ obj, newObj }) },
      ]}
    />
  );
}
```

### å¤æ‚æ•°æ®çš„æ·±æ‹·è´

æ•°æ®çš„æ·±æ‹·è´ç®€å•æ¥è¯´å°±æ˜¯å°†ä¸€ä¸ª **å¼•ç”¨ç±»å‹** çš„æ•°æ®ä»å†…å­˜ä¸­å®Œæ•´çš„æ‹·è´ä¸€ä»½å‡ºæ¥ï¼Œä» `å †` å†…å­˜ä¸­å¼€è¾Ÿä¸€ä¸ªæ–°çš„åŒºåŸŸå­˜æ”¾è¯¥å¯¹è±¡ï¼Œä¸”ä¿®æ”¹æ–°æ•°æ®ä¸ä¼šå½±å“åˆ°åŸæ•°æ®;

```jsx title="ä»£ç å®ç° - å£¹"
// ä½¿ç”¨ JSON è‡ªå¸¦çš„ä¸¤ä¸ªæ–¹æ³•è¿›è¡Œæ·±æ‹·è´;
// ğŸ“¢ ç¼ºç‚¹ï¼šè™½ç„¶å¯ä»¥åº”å¯¹å¤§éƒ¨åˆ†çš„æ•°æ®åœºæ™¯ï¼Œä½†æ˜¯å¯¹äºæ‹·è´å‡½æ•°ï¼Œå¾ªç¯å¼•ç”¨ç­‰ä¸èµ·ä½œç”¨
export const _deepClone = (data: any) => {
  return JSON.parse(JSON.stringify(data));
};
```

```jsx title="ä»£ç å®ç° - è´°"
// ä½¿ç”¨ é€’å½’ çš„æ–¹å¼è¿›è¡Œæ·±æ‹·è´ï¼Œä¸”éœ€é¿å…å¾ªç¯å¼•ç”¨çš„é—®é¢˜
// ğŸ‹ åˆ¤æ–­æ•°æ®æ˜¯å¦ä¸º åŸå§‹æ•°æ®ç±»å‹
const isObject = (target) => {
  const type = typeof target;
  return target !== null && (type === 'object' || type === 'function');
};

// ğŸ‹ è·å–æ•°æ®çš„ç±»å‹ï¼Œè¿”å›ä¸€ä¸ªå­—ç¬¦ä¸²ï¼Œæ ¼å¼ä¸º '[object Type]'
const getType = (target): string => {
  return Object.prototype.toString.call(target);
};

// ğŸ‹ åˆå§‹åŒ–è¢«å…‹éš†çš„å¯¹è±¡ï¼Œä¿æŒç»§æ‰¿é“¾
const getInit = (target) => {
  return new target.constructor();
};

// ğŸ‹ ä½¿ç”¨ while å°è£…ä¸€ä¸ª forEach å‡½æ•°ï¼Œä¼˜åŒ–å¾ªç¯çš„æ€§èƒ½ï¼Œå…¶ä¸­ iteratee æ˜¯ä¸€ä¸ªå›è°ƒå‡½æ•°ï¼Œæ¥æ”¶æ¯æ¬¡éå†çš„ value å’Œ index ä¸ºå‚æ•°ï¼ˆå¯ä½¿ç”¨ for...in å¾ªç¯ä»£æ›¿ï¼‰
const forEach = (array: any[], iteratee: (v: any, i: number) => void) => {
  let index = -1;
  const length = array.length;
  while (++index < length) {
    iteratee(array[index], index);
  }
  return array;
};

// å°è£…å…‹éš†å‡½æ•°
export const _deepClone = (target: any, map = new WeakMap()) => {
  // å¤„ç† nullï¼ŒåŸå§‹æ•°æ®ï¼ŒDateï¼ŒRegexp ç±»å‹
  if (target === null) return null;
  if (!isObject(target)) return target;
  if (getType(target) === '[object Date]') return new Date(target);
  if (getType(target) === '[object Regexp]') return new RegExp(target);

  // åˆå§‹åŒ–è¢«å…‹éš†çš„å¯¹è±¡
  const cloneTarget = getInit(target);

  // å¤„ç†å¾ªç¯å¼•ç”¨
  if (map.get(target)) return map.get(target);
  map.set(target, cloneTarget);

  // å¤„ç†æ•°ç»„å’Œå¯¹è±¡çš„æ•°æ® - ä½¿ç”¨ for...in å¾ªç¯
  for (const key in target) {
    // target ä¸ºæ•°ç»„æ—¶ï¼Œkey ä¸ºæ•°ç»„çš„ç´¢å¼•å€¼
    if (Object.prototype.hasOwnProperty.call(target, key)) {
      cloneTarget[key] = _deepClone(target[key], map);
    }
  }
  // æˆ–ï¼šå¤„ç†æ•°ç»„å’Œå¯¹è±¡çš„æ•°æ® - ä½¿ç”¨ å°è£…å¥½çš„ forEach å‡½æ•°
  const keys = getType(target) === '[object Object]' ? Object.keys(target) : undefined;
  forEach(keys || target, (value, key) => {
    if (keys) key = value; // å¦‚æœæ˜¯å¯¹è±¡ï¼Œå°†å¯¹è±¡çš„ å±æ€§ èµ‹ç»™ ç´¢å¼•å€¼
    cloneTarget[key] = _deepClone(target[key], map);
  });

  return cloneTarget;
};
```

```jsx title="ä»£ç å®ç° - å"
// ä½¿ç”¨ç¬¬ä¸‰æ–¹åº“ lodash çš„ cloneDeep() å‡½æ•°;
import { cloneDeep } from 'lodash';

const cloneTarget = cloneDeep(target);
```

ç¤ºä¾‹:

```jsx live
function ExampleComponent(props) {
  const arr = ['åŸºç¡€æ•°æ®ç±»å‹', { name: 'dino' }];
  const newArr = _deepClone(arr); // æ·±æ‹·è´
  newArr[1].name = 'å‹ºå­ ğŸ¶';

  const obj = { name: 'dino', havebeen: [{ city: 'æ­¦æ±‰' }, { city: 'æ­å·' }], date: new Date() };
  const newObj = _deepClone(obj); // æ·±æ‹·è´
  newObj.havebeen.push({ city: 'é»„å†ˆ' }); // ä¿®æ”¹å…‹éš†åçš„æ•°æ®ï¼Œä¸ä¼šå½±å“åˆ°åŸæ•°æ®
  newObj.date = '2022-03-09';

  const [value, setValue] = useState();

  return (
    <ResultButton
      results={value}
      buttonGroup={[
        { text: 'æ˜¾ç¤ºç»“æœ(æ•°ç»„çš„æ·±æ‹·è´)', onClick: () => setValue({ arr, newArr }) },
        { text: 'æ˜¾ç¤ºç»“æœ(å¯¹è±¡çš„æ·±æ‹·è´)', onClick: () => setValue({ obj, newObj }) },
      ]}
    />
  );
}
```

## æ¯”è¾ƒ

### æ¯”è¾ƒä¸¤ç»„æ•°æ®æ˜¯å¦å…¨ç­‰

- å½“ä¸¤ç»„ç›¸åŒçš„ **å¼•ç”¨ç±»å‹** æ•°æ®è¿›è¡Œæ¯”è¾ƒæ—¶ï¼Œç”±äºå®ƒä»¬çš„æ•°æ®å­˜å‚¨åœ¨ `å †` ä¸­ï¼Œ`æ ˆ` ä¸­å­˜å‚¨çš„æ˜¯åœ°å€ï¼Œå³ä¾¿æ•°æ®å†…å®¹ç›¸åŒï¼Œä½†æ˜¯äºŒè€…çš„åœ°å€éƒ½æ˜¯ç‹¬ç«‹çš„ï¼Œæ‰€ä»¥äºŒè€…ç›¸æ¯”è¾ƒç»“æœæ€»æ˜¯ **ä¸ç­‰** çš„;
- å¯ä»¥ä½¿ç”¨ **é€’å½’** çš„æ–¹å¼å¯¹ä¸¤ä¸ªå¼•ç”¨ç±»å‹çš„æ•°æ®è¿›è¡Œæ¯”è¾ƒ;

```jsx title="ä»£ç å®ç° - å£¹"
// ä½¿ç”¨ JSON.stringify() å°†æ•°æ®è½¬æ¢æˆå­—ç¬¦ä¸²è¿›è¡Œæ¯”è¾ƒï¼Œç®€å•ç²—æš´;
// ğŸ“¢ ç¼ºç‚¹ï¼šå…·æœ‰é™åˆ¶æ€§ï¼Œå½“æ¯”è¾ƒä¸¤ä¸ª key é¡ºåºä¸åŒï¼Œvalue ç›¸åŒçš„å¯¹è±¡æ—¶ï¼Œå°±ä¼šæ— æ•ˆ
export const _equals = (origin: any, target: any): boolean => {
  return JSON.stringify(origin) === JSON.stringify(target);
};
```

```jsx title="ä»£ç å®ç° - è´°"
// ä½¿ç”¨ é€’å½’ çš„æ–¹å¼è¿›è¡Œæ·±åº¦æ¯”è¾ƒ
// ğŸ‹ è·å–æ•°æ®çš„ç±»å‹ï¼Œè¿”å›ä¸€ä¸ªå­—ç¬¦ä¸²ï¼Œæ ¼å¼ä¸º '[object Type]'
const getType = (target): string => {
  return Object.prototype.toString.call(target);
};

// å°è£…å‡½æ•°
export const _equals = (origin: any, target: any): boolean => {
  // å¤„ç†åŸå§‹æ•°æ®ç±»å‹ï¼Œç›¸åŒæ—¶ç›´æ¥è¿”å› true
  if (origin === target) return true;

  // å¤„ç† NaN çš„æƒ…å†µï¼Œåˆ©ç”¨ NaN !== NaN è¿›è¡Œåˆ¤æ–­
  if (origin !== origin) return target !== target;

  // å¤„ç† Dateï¼Œ RegExp ç±»å‹
  if (getType(origin) !== getType(target)) return false;
  switch (getType(origin)) {
    case '[object Date]':
      return +origin === +target;
    case '[object RegExp]':
      return '' + origin === '' + target;
  }

  // å½“é€’å½’ä¹‹åçš„ origin å’Œ target ä¸æ˜¯ object ç±»å‹ï¼Œä¸”å€¼ä¸ç›¸åŒæ—¶ï¼Œä¼šèµ°åˆ°è¯¥é€»è¾‘ä¸­ï¼›é˜²æ­¢å¯¹è±¡é™·å…¥æ­»å¾ªç¯
  if (!origin || !target || (typeof origin !== 'object' && typeof target !== 'object'))
    return origin === target;

  // å¤„ç† æ•°ç»„ å’Œ å¯¹è±¡
  const keys = Object.keys(origin);
  if (keys.length !== Object.keys(target).length) return false;
  return keys.every((item) => _equals(origin[item], target[item])); // ä½¿ç”¨ Array.every æ–¹æ³•
};
```

```jsx title="ä»£ç å®ç° - å"
// ä½¿ç”¨ç¬¬ä¸‰æ–¹åº“ lodash çš„ isEqual() å‡½æ•°;
import { isEqual } from 'lodash';

const flag = isEqual(target, target_1);
```

ç¤ºä¾‹:

```jsx live
function ExampleComponent(props) {
  const arr = ['ğŸ˜„ğŸ˜„', { name: 'dino ğŸ¦–' }];
  const arr_1 = ['ğŸ˜„ğŸ˜„', { name: 'dino ğŸ¦–' }];

  const obj = { name: 'dino', havebeen: [{ city: 'æ­¦æ±‰' }], date: new Date() };
  const obj_1 = { name: 'dino', date: new Date(), havebeen: [{ city: 'æ­å·' }] };

  const [value, setValue] = useState();

  return (
    <ResultButton
      results={value}
      buttonGroup={[
        { text: 'æ˜¾ç¤ºç»“æœ(æ•°ç»„çš„æ·±åº¦æ¯”è¾ƒ)', onClick: () => setValue('' + _isEqual(arr, arr_1)) },
        { text: 'æ˜¾ç¤ºç»“æœ(å¯¹è±¡çš„æ·±åº¦æ¯”è¾ƒ)', onClick: () => setValue('' + _isEqual(obj, obj_1)) },
      ]}
      openJsonView={false}
    />
  );
}
```

## æ’åº

### æ‰“ä¹±ä¸€ä¸ªæ•°ç»„çš„é¡ºåº

### å†’æ³¡æ’åº

## ç›¸å…³é“¾æ¥

- [å¦‚ä½•å†™å‡ºä¸€ä¸ªæƒŠè‰³é¢è¯•å®˜çš„æ·±æ‹·è´? - æ˜é‡‘](https://juejin.cn/post/6844903929705136141)
