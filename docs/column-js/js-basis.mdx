---
title: JS åŸºç¡€å·©å›º ğŸ“¦
id: js-basis
sidebar_position: 1
toc_max_heading_level: 4
---

```mdx-code-block
import { Image } from '@arco-design/web-react';
```

> æœ¬ç« èŠ‚ç®€å•è®°å½• JavaScript çš„ä¸€äº›åŸºç¡€çŸ¥è¯† & é¢è¯•å¸¸è§çš„é—®é¢˜ï¼Œå¦‚ åŸå‹ã€é—­åŒ… ç­‰;

## æ•°æ®ç±»å‹

### è·å–å…ƒç´ çš„ç±»å‹

è·å–ç›®æ ‡å¯¹è±¡çš„ç±»å‹ï¼Œè¿”å›ä¸€ä¸ªå­—ç¬¦ä¸²;

```jsx title="ä»£ç å®ç°" showLineNumbers
export const _getType = (target: any) => {
  return Object.prototype.toString.call(target);
};

// è°ƒç”¨
_getType(undefined); // '[object Undefined]'
_getType(null); // '[object Null]'
_getType({ name: 'dino' }); // '[object Object]'
_getType([1, 2]); // '[object Array]'
_getType(/\d/g); // '[object RegExp]'
_getType(Symbol('dino')); // '[object Symbol]'ï¼›es6 æ–°å¢çš„åŸå§‹æ•°æ®ç±»å‹ï¼ŒSymbol() ä¸­è¿”å›çš„å€¼éƒ½æ˜¯å”¯ä¸€çš„

_getType(Array); // '[object Function]'ï¼Œæ„é€ å‡½æ•°
_getType(new Array()); // '[object Array]'ï¼Œå®ä¾‹åŒ–å¯¹è±¡
```

### åŸå§‹æ•°æ®ç±»å‹ çš„è½¬æ¢

æœ€åŸºæœ¬çš„åŸå§‹æ•°æ®ç±»å‹ `string`ã€`number` å’Œ `boolean` ä¹‹é—´çš„è½¬æ¢;

##### â†’ String

```js title="ä»£ç å®ç°" showLineNumbers
// 1ï¸âƒ£ ä½¿ç”¨ toString() æ–¹æ³•
false.toString(); // 'false'
[52].toString(); // '52'

// 2ï¸âƒ£ ä½¿ç”¨ JSON.stringify() æ–¹æ³•
JSON.stringify(123); // '123'

// 3ï¸âƒ£ ä½¿ç”¨ String() æ–¹æ³•
String([]); // ""
String(['52']); // "52"
String({}); // "[object Object]"
String(null); // "null"
String(undefined); // "undefined"
String(true); // "true"

// 4ï¸âƒ£ ä½¿ç”¨ éšå¼è½¬æ¢ï¼ŒåŒ String() ä¸€è‡´
'' + 123; // '123'
```

:::caution `toString()` çš„å‚æ•°

- `toString()` å¯¹ **æ•°å€¼(number ç±»å‹)** æ¥è¯´ï¼Œæ˜¯è½¬æ¢æˆå¯¹åº”çš„ **è¿›åˆ¶å­—ç¬¦ä¸²**ï¼Œè¯¥æ–¹æ³•å¯ä¼ ä¸€ä¸ªå‚æ•°ï¼Œè¡¨ç¤ºå¯¹åº”çš„ **è¿›åˆ¶**ï¼Œé»˜è®¤ä¸º **åè¿›åˆ¶**;

```js showLineNumbers
(520).toString(); // '520'ï¼Œåè¿›åˆ¶ï¼ˆé»˜è®¤ï¼‰
(520).toString(2); // '1000001000'ï¼ŒäºŒè¿›åˆ¶
(520).toString(8); // '1010'ï¼Œå…«è¿›åˆ¶
(520).toString(16); // '208'ï¼Œåå…­è¿›åˆ¶
(520).toString(32); // 'g8'ï¼Œä¸‰åäºŒè¿›åˆ¶
```

:::

##### â†’ Number

```js title="ä»£ç å®ç°" showLineNumbers
// 1ï¸âƒ£ ä½¿ç”¨ parseInt() æ–¹æ³•ï¼Œå®ƒä¼šå°† æµ®ç‚¹æ•° è½¬æ¢æˆ æ•´æ•°
parseInt('3.1415'); // 3
parseInt('100++'); // 100
parseInt('++100'); // NaN
parseInt(true); // NaN

// 2ï¸âƒ£ ä½¿ç”¨ parseFloat() æ–¹æ³•ï¼ŒåŒ parseInt() ä¸€è‡´ï¼Œä½†æ˜¯å®ƒä¸ä¼šå°† æµ®ç‚¹æ•° è½¬æ¢æˆ æ•´æ•°
parseFloat('3.14'); // 3.14

// 3ï¸âƒ£ ä½¿ç”¨ Number() æ–¹æ³•
Number(); // 0
Number(null); // 0
Number(false); // 0
Number(''); // 0
Number(' '); // 0ï¼ŒåŠ äº†ç©ºæ ¼çš„å­—ç¬¦ä¸²

Number(true); // 1
Number([]); // 0
Number(['']); // 0
Number(['5']); // 5

Number(['5', '2']); // NaN
Number({}); // NaN
Number(undefined); // NaN

Number(' 3.14 '); // 3.14
Number(' 3.14 222'); // NaN

// 4ï¸âƒ£ ä½¿ç”¨ éšå¼è½¬æ¢ï¼ŒåŒ Number() ä¸€è‡´
+'3.14'; // 3.14
```

:::caution `Number()` åœ¨å¯¹ç›®æ ‡å€¼è½¬æ¢çš„è¿‡ç¨‹ä¸­ï¼Œä¼šå‘ç”Ÿä»€ä¹ˆ?

- ç›®æ ‡å¯¹è±¡ å…ˆè°ƒç”¨è‡ªèº«çš„ `valueOf()` æ–¹æ³•(è¿”å›ç›®æ ‡å¯¹è±¡çš„åŸå§‹å€¼)ï¼Œè‹¥è¿”å›çš„æ˜¯ **åŸå§‹ç±»å‹**ï¼Œåˆ™ç›´æ¥ä½¿ç”¨ `Number()` æ–¹æ³•; è‹¥è¿”å›çš„æ˜¯ **å¼•ç”¨ç±»å‹**ï¼Œä¼šå†è°ƒç”¨ `toString()` æ–¹æ³•;
- è‹¥è°ƒç”¨ `toString()` æ–¹æ³•åï¼Œè¿”å›çš„è¿˜æ˜¯ä¸€ä¸ªå¯¹è±¡ï¼Œåˆ™ä¼šæŠ›å‡ºé”™è¯¯;

```js showLineNumbers
Number(['5']); // ç›¸å½“äº Number(['5'].valueOf().toString())
```

:::

:::caution `parseInt()` çš„å‚æ•°

- `parseInt()` å¯ä¼ ç¬¬äºŒä¸ªå‚æ•°ï¼Œè¡¨ç¤ºå¯¹åº”çš„ **è¿›åˆ¶æ•°**ï¼Œé»˜è®¤ä¸º **åè¿›åˆ¶**; ä½†å®ƒå’Œ `toString()` çš„è®¡ç®—æ–¹å¼åˆšå¥½ç›¸å;

```js showLineNumbers
parseInt('1000001000'); // 1000001000
parseInt('1000001000', 2); // 520
parseInt('1010', 8); // 520
parseInt('208', 16); // 520
parseInt('g8', 32); // 520
```

:::

##### â†’ Boolean

```js title="ä»£ç å®ç°" showLineNumbers
// 1ï¸âƒ£ ä½¿ç”¨ Boolean() æ–¹æ³•
Boolean([]); // true
Boolean(0); // false
Boolean(NaN); // false

// 2ï¸âƒ£ ä½¿ç”¨ éšå¼è½¬æ¢ï¼ŒåŒ Boolean() ä¸€è‡´(! è¡¨ç¤ºéï¼›!! è¡¨ç¤ºè½¬æ¢)
!!{}; // true
!!''; // false
!!null; // false
```

<!-- ## æ‹“å±•é“¾æ¥ ğŸ“¦ -->

:::tip æ‹“å±•èµ„æ–™

- ğŸ‘‰ [ä½ çœŸçš„æŒæ¡å˜é‡å’Œç±»å‹äº†å—? - æ˜é‡‘](https://juejin.cn/post/6844903854882947080)
- ğŸ‘‰ [åœ¨çº¿è¿›åˆ¶è½¬æ¢å·¥å…·](https://tool.lu/hexconvert/)

:::

### åˆ¤æ–­ å¯¹è±¡ æ˜¯å¦ä¸ºç©º

```jsx title="ä»£ç å®ç°" showLineNumbers
// 1ï¸âƒ£ å°†å¯¹è±¡è½¬æˆå­—ç¬¦ä¸²
JSON.stringify({}); // '{}';

// 2ï¸âƒ£ å°†å¯¹è±¡çš„ key å€¼ç»„æˆä¸€ä¸ªæ•°ç»„
Object.keys({}).length; // 0
// æˆ–
Object.getOwnPropertyNames({}).length; // 0

// 3ï¸âƒ£ ä½¿ç”¨ç¬¬ä¸‰æ–¹åº“ lodash ä¸­çš„ isEmpty() æ–¹æ³•
import { isEmpty } from 'lodash';

isEmpty({}); // true
```

:::caution ç¦»ç¦»åŸä¸Šè°±

- **lodash** ä¸­çš„ `isEmpty()` æ–¹æ³•ä¸»è¦ç”¨æ¥åˆ¤æ–­ç›®æ ‡å€¼æ˜¯å¦ä¸ºç©ºï¼Œä¸ºç©ºåˆ™è¿”å› `true`ï¼ŒåŒ…æ‹¬ `null`ã€`undefined` åŠ `ç©ºæ•°ç»„` ç­‰;
- ğŸ“¢ å½“ `isEmpty()` ä¸­çš„ç›®æ ‡å€¼ä¸º `1` æ—¶ï¼Œä¹Ÿä¼šè¿”å› `true`ï¼ˆè¯¥æƒ…å†µæ¯”è¾ƒç‰¹æ®Šï¼‰;

```js showLineNumbers
isEmpty(null); // true
isEmpty(0); // true
isEmpty(1); // true
isEmpty(true); // true
isEmpty(false); // true
isEmpty([]); // true
isEmpty(''); // true
isEmpty(' '); // falseï¼ŒåŠ äº†ç©ºæ ¼çš„å­—ç¬¦ä¸²
```

:::

## è¿ç®—ç¬¦

##### == è¿ç®—ç¬¦

- ä½¿ç”¨ `==` åšæ¯”è¾ƒæ—¶ï¼Œåªä¼šæ¯”è¾ƒå€¼ï¼Œä¸ä¼šæ¯”è¾ƒç±»å‹ï¼Œå› æ­¤ **ä¸å»ºè®®åœ¨å®é™…å¼€å‘ä¸­ä½¿ç”¨**;
- `==` è¿ç®—ç¬¦ æœ¬è´¨ä¸Šæ˜¯å°†ä¸¤ä¾§çš„å†…å®¹è½¬æ¢æˆ `Number` ç±»å‹ï¼Œå†è¿›è¡Œæ¯”è¾ƒ;
- `Boolean` ç±»å‹çš„å€¼åœ¨å’Œå…¶ä»–ç±»å‹è¿›è¡Œ **æ¯”è¾ƒ** æ—¶ï¼Œè¯¥å€¼ä¼˜å…ˆè¢«è½¬æ¢æˆ `Number` ç±»å‹;

```js showLineNumbers
true == 1; // true
true == '1'; // true
true == ['1']; // trueï¼Œå› ä¸º å¼•ç”¨ç±»å‹ ['1'] ä¼šè¢«è½¬æ¢æˆ Number ç±»å‹
true == 2; // false

![] == []; // trueï¼Œå› ä¸º ! çš„ä¼˜å…ˆçº§è¦é«˜äº ==ï¼Œå› æ­¤ä¼šå…ˆå°† ![] è½¬ä¸º falseï¼Œå†è½¬ä¸º Number ç±»å‹

null == undefined; // trueï¼Œé™¤æ­¤ä¹‹å¤–ï¼Œnull å’Œ undefined ä¸ä»»æ„å€¼è¿›è¡Œæ¯”è¾ƒï¼Œç»“æœéƒ½ä¸º false
```

##### + è¿ç®—ç¬¦

- å½“ä¸€ä¾§ä¸º `String` ç±»å‹ï¼Œå¦ä¸€ä¾§ä¸ºä»»æ„ç±»å‹ï¼Œä¼šä¼˜å…ˆå°†å¦ä¸€ä¾§çš„å†…å®¹è½¬æ¢ä¸º `String` ç±»å‹ï¼Œå†è¿›è¡Œå­—ç¬¦ä¸²æ‹¼æ¥;
- å½“ä¸€ä¾§ä¸º `Number` ç±»å‹ï¼Œå¦ä¸€ä¾§ä¸º **åŸå§‹ç±»å‹ï¼ˆé™¤ String å¤–ï¼‰**ï¼Œä¼šå°†å¦ä¸€ä¾§çš„å†…å®¹è½¬æ¢ä¸º `Number` ç±»å‹ï¼Œå†è¿›è¡ŒåŠ æ³•è¿ç®—;
- å½“ä¸€ä¾§ä¸º `Number` ç±»å‹ï¼Œå¦ä¸€ä¾§ä¸º **å¼•ç”¨ç±»å‹**ï¼Œä¼šå°†å¦ä¸€ä¾§çš„å†…å®¹è½¬æ¢ä¸º `String` ç±»å‹ï¼Œå†è¿›è¡Œå­—ç¬¦ä¸²æ‹¼æ¥;

```js showLineNumbers
'123' + {}; // "123[object Object]"
'123' + false; // "123false"

123 + true; // 124

123 + {}; // "123[object Object]"
123 + [456]; // "123456"
```

## æ„é€ å‡½æ•° & å®ä¾‹åŒ–å¯¹è±¡

##### ä»€ä¹ˆæ˜¯æ„é€ å‡½æ•°?

- **æ„é€ å‡½æ•°** ç®€è¨€ä¹‹å°±æ˜¯ä¸€ç§èƒ½ **æ„é€ å‡ºå¯¹è±¡** çš„å‡½æ•°ï¼Œç”¨æ¥åˆå§‹åŒ–å¯¹è±¡ï¼Œä¸ºå¯¹è±¡æˆå‘˜å˜é‡èµ‹äºˆåˆå§‹å€¼ï¼Œæ€»ä¸ `new` å…³é”®å­—ä¸€èµ·ä½¿ç”¨;
- `Array` æ˜¯ JS å†…ç½®çš„ **å…¨å±€å¯¹è±¡**ï¼ŒåŒæ—¶å®ƒä¹Ÿæ˜¯ä¸€ä¸ª **æ„é€ å‡½æ•°**ï¼Œä¸ä¹‹ç›¸ä¼¼çš„è¿˜æœ‰ `Object`ã€`String`ã€`Number` ç­‰å†…ç½®å¯¹è±¡;

```js showLineNumbers
typeof Array; // 'function'
```

##### ä»€ä¹ˆæ˜¯å®ä¾‹åŒ–å¯¹è±¡?

- **å®ä¾‹åŒ–å¯¹è±¡** æ˜¯é€šè¿‡ `new` å…³é”®å­—æ¥æ‰§è¡Œä¸€ä¸ª **æ„é€ å‡½æ•°**ï¼Œç„¶åè¿”å›ä¸€ä¸ªæ™®é€šå¯¹è±¡;
- é€šè¿‡è¯¥å¯¹è±¡ï¼Œå¯ä»¥è®¿é—®åˆ°å…¶å¯¹åº”çš„æ„é€ å‡½æ•°ä¸­ å®šä¹‰çš„å†…å®¹ æˆ– åŸå‹ `prototype` ä¸­å®šä¹‰çš„å†…å®¹;

```js showLineNumbers
typeof new Array(); // 'object'
```

##### æ„é€ å‡½æ•°ä¸­çš„è¿”å›å€¼

- æ„é€ å‡½æ•°é»˜è®¤è¿”å›çš„æ˜¯è¯¥å‡½æ•°çš„ `this`;
- è‹¥æ„é€ å‡½æ•°ä¸­æ²¡æœ‰æŒ‡å®šè¿”å›å€¼ï¼Œæˆ–æŒ‡å®šçš„è¿”å›å€¼ä¸º **åŸå§‹ç±»å‹**ï¼Œåˆ™è¯¥è¿”å›å€¼æ˜¯æ— æ•ˆçš„ï¼Œå…¶å¯¹åº”çš„å®ä¾‹åŒ–å¯¹è±¡å¯ä»¥ç›´æ¥è®¿é—®è¯¥å‡½æ•°ä¸­ **é€šè¿‡ `this` å®šä¹‰çš„å†…å®¹** æˆ– **é€šè¿‡ `prototype` å®šä¹‰çš„å†…å®¹**;
- è‹¥æ„é€ å‡½æ•°è¿”å›äº†ä¸€ä¸ª **å¼•ç”¨ç±»å‹**ï¼Œåˆ™å®ä¾‹åŒ–å¯¹è±¡ **åªèƒ½è®¿é—®è¯¥å¼•ç”¨ç±»å‹çš„å€¼**;

```js showLineNumbers
// åˆ›å»ºä¸€ä¸ªæ„é€ å‡½æ•° & å®ä¾‹åŒ–å¯¹è±¡ï¼Œè¿”å›ä¸€ä¸ª åŸå§‹ç±»å‹
function Person() {
  this.name = 'dino';
  return 'ğŸ˜„ğŸ˜„ğŸ˜„';
}
Person.prototype.age = 26;
const p = new Person();
p.name; // 'dino'
p.age; // 26

// åˆ›å»ºä¸€ä¸ªæ„é€ å‡½æ•° & å®ä¾‹åŒ–å¯¹è±¡ï¼Œè¿”å›ä¸€ä¸ª å¼•ç”¨ç±»å‹
function Person_1() {
  this.name = 'dino';
  return { name: 'å¤§è„¸è„¸' };
}
Person.prototype.age = 26;
const p1 = new Person_1();
p1.name; // 'å¤§è„¸è„¸'
p1.age; // undefined
```

##### `new A()` åœ¨æ‰§è¡Œçš„è¿‡ç¨‹ä¸­å‘ç”Ÿäº†ä»€ä¹ˆ?

- åˆ›å»ºäº†ä¸€ä¸ª **ç©ºå¯¹è±¡**(æ–°å»ºäº†ä¸€ä¸ªå†…å­˜ç©ºé—´)ï¼Œè®©è¯¥å¯¹è±¡çš„ `__proto__` æŒ‡å‘ æ„é€ å‡½æ•° A çš„ `prototype`;
- æ”¹å˜ `this` æŒ‡å‘ï¼Œè®©åŸæœ¬æŒ‡å‘ `window` çš„ç»‘å®šå¯¹è±¡ `this`ï¼ŒæŒ‡å‘åˆšåˆ›å»ºå¥½çš„ ç©ºå¯¹è±¡;
- æ‰§è¡Œæ„é€ å‡½æ•°ä¸­ A ä¸­çš„ä»£ç ï¼Œç»™è¿™ä¸ªæ–°å¯¹è±¡æ·»åŠ å±æ€§æˆ–æ–¹æ³•;
- è¿”å›è¿™ä¸ªæ–°å¯¹è±¡;

:::caution å¦‚ä½•æ‰‹åŠ¨å®ç°ä¸€ä¸ª `new`?

```js title="ä»£ç å®ç°" showLineNumbers
function newOperator(fn, ...args) {
  // args è¡¨ç¤ºå‰©ä½™å‚æ•°é›†åˆ
  // åˆ›å»ºä¸€ä¸ªæ–°å¯¹è±¡ objï¼Œè®©å®ƒçš„åŸå‹é“¾ __proto__ æŒ‡å‘ fn.prototype å¯¹è±¡
  const obj = Object.creat(fn.prototype);
  // æˆ–
  // const obj = {};
  // Object.setPrototypeOf(obj, fn.prototype);  // ä¸º obj å¯¹è±¡è®¾ç½®ä¸€ä¸ªåŸå‹

  console.log(obj.__proto__ === fn.prototype); // true

  // æ”¹å˜ this æŒ‡å‘ï¼Œä½¿ obj èƒ½è®¿é—®åˆ° fn å‡½æ•°ä¸­çš„å±æ€§æˆ–æ–¹æ³•
  // æ„é€ å‡½æ•°ä¸­çš„ è¿”å›å€¼æ˜¯ä»€ä¹ˆï¼Œret å°±æ˜¯ä»€ä¹ˆï¼›å¦‚æœæ²¡æœ‰è¿”å›å€¼ï¼Œåˆ™ ret ä¸º undefined
  const ret = fn.bind(obj)(...args);
  // æˆ–
  // const ret = fn.call(obj, ...args);
  // æˆ–
  // const ret = fn.apply(obj, args);

  // è¿”å› æ–°å¯¹è±¡ obj
  return typeof ret === 'object' ? ret : obj;
}

// è°ƒç”¨
function Person(name) {
  this.name = name;
}
const p = newOperator(Person, 'dino');
p.name; // 'dino'
```

:::

:::tip å‚è€ƒèµ„æ–™

- ğŸ‘‰ [å®ä¾‹å¯¹è±¡ä¸ new å‘½ä»¤](https://wangdoc.com/javascript/oop/new.html)

:::

## åŸå‹ & åŸå‹é“¾

##### `prototype` å¯¹è±¡

- **æ‰€æœ‰ å‡½æ•°** éƒ½å…·æœ‰(**ç‹¬æœ‰**) `prototype` å±æ€§(æ˜¾å¼åŸå‹)ï¼Œå®ƒæ˜¯ä¸€ä¸ªæ™®é€šå¯¹è±¡ï¼Œä¹Ÿç§°ä¸º **åŸå‹å¯¹è±¡**;
- **æ‰€æœ‰ æ„é€ å‡½æ•°** çš„ **å®ä¾‹åŒ–å¯¹è±¡** éƒ½å¯ä»¥åœ¨è¯¥å‡½æ•°çš„ `prototype` ä¸­æ‰¾åˆ°å®šä¹‰çš„å…¬ç”¨å±æ€§æˆ–æ–¹æ³•;

```js showLineNumbers
// åˆ›å»ºä¸€ä¸ªæ„é€ å‡½æ•° & å®ä¾‹åŒ–å¯¹è±¡
function Person(name) {
  this.name = name;
}
Person.prototype.age = 26; // å®šä¹‰å¯å…¬ç”¨çš„å±æ€§æˆ–æ–¹æ³•

const p = new Person('dino');

p.name; // 'dino'
p.age; // 26
```

##### `__proto__` å¯¹è±¡

- **æ‰€æœ‰ å¯¹è±¡** (JS ä¸‡ç‰©çš†å¯¹è±¡)éƒ½å…·æœ‰ä¸€ä¸ª `__proto__` å±æ€§(éšå¼åŸå‹)ï¼Œä¹Ÿç§°ä¸º **åŸå‹é“¾å¯¹è±¡**ï¼Œå®ƒ **æŒ‡å‘è¯¥å¯¹è±¡çš„ æ„é€ å‡½æ•° çš„ `prototype`**;

```js showLineNumbers
new Array().__proto__ === Array.prototype; // true
new Object().__proto__ === Object.prototype; // true
new Function().__proto__ === Function.prototype; // true

const obj = { name: 'dino' }; // åˆ›å»ºå¯¹è±¡æ—¶ï¼Œå®è´¨ä¸Šæ˜¯æ‰§è¡Œäº† new Object({ name: 'dino' })
obj.__proto__ === Object.prototype; // true
```

- **æ‰€æœ‰ å¯¹è±¡** çš„ **åŸå‹é“¾** ä¼šé€å±‚çš„å‘ä¸ŠæŸ¥æ‰¾ï¼Œæœ€ç»ˆéƒ½ä¼šæŒ‡å‘ `Object.prototype`ï¼Œè€ŒåŸå‹é“¾çš„å°½å¤´ï¼Œåˆ™ä¸º `null`;

```js showLineNumbers
Array.prototype.__proto__ === Object.prototype; // true
Function.prototype.__proto__ === Object.prototype; // true

// åŸå‹é“¾çš„ å°½å¤´
Object.prototype.__proto__ === null; // true
```

##### `constructor` å±æ€§

- **æ‰€æœ‰ å¯¹è±¡** éƒ½å…·æœ‰ä¸€ä¸ª `constructor` å±æ€§ï¼Œå®ƒ **æŒ‡å‘è¯¥å¯¹è±¡çš„ æ„é€ å‡½æ•°**;

```js showLineNumbers
[].constructor === Array; // true
({ name: 'dino' }.constructor === Object); // true
(123).constructor === Number; // true
```

:::tip å‚è€ƒèµ„æ–™

- ğŸ‘‰ [js çš„åŸå‹å’ŒåŸå‹é“¾æ˜¯ä»€ä¹ˆ - php ä¸­æ–‡ç½‘](https://m.php.cn/article/462738.html)

:::

## this å…³é”®å­—

- this å…³é”®å­—å¤šç”¨åœ¨å‡½æ•°ä½“å†…ï¼Œéƒ½æœ‰ä¸€ä¸ªå…±åŒç‚¹ï¼Œ**æ€»æ˜¯è¿”å›ä¸€ä¸ª å¯¹è±¡**ï¼Œä¹Ÿå°±æ˜¯ç®€å•ç†è§£æˆ this å®šä¹‰çš„å±æ€§æˆ–æ–¹æ³•æ˜¯ **"å½“å‰" æ‰€åœ¨çš„å¯¹è±¡(å¯ç§°ä¹‹ä¸º å®¿ä¸»)** ä¸­çš„å±æ€§æˆ–æ–¹æ³•ï¼Œä¸” **ä¸ä¼šç»§æ‰¿ä¸Šä¸€å±‚çš„å¯¹è±¡**;
- ç®€è¨€ä¹‹: å‡½æ•°ä¸­çš„ this æŒ‡å‘ **å½“å‰è°ƒç”¨è¯¥å‡½æ•°çš„ ç¯å¢ƒ**;
- this åœ¨é»˜è®¤æƒ…å†µä¸‹æŒ‡å‘çš„æ˜¯ `window` å¯¹è±¡; è€Œåœ¨ ä¸¥æ ¼æ¨¡å¼ `use strict` ä¸‹ï¼Œthis çš„é»˜è®¤å€¼ä¸º `undefined`;
- this çš„æŒ‡å‘æ˜¯ **åŠ¨æ€æ”¹å˜çš„**ï¼Œå®ƒä¼šéšç€å½“å‰å®¿ä¸»çš„æ”¹å˜è€Œå‘ç”Ÿæ”¹å˜ï¼Œæ¯”å¦‚ä»¥ä¸‹ç¤ºä¾‹;

```js title="ä»£ç ç¤ºä¾‹" showLineNumbers
const pets = {
  names: 'èŠ±å·',
  func: function () {
    return `Its name is ${this?.names}`; // æ­¤æ—¶çš„ this æŒ‡å‘å½“å‰çš„ obj å¯¹è±¡
  },
  child: {
    names: 'å“ˆæ‰¹',
    func: function () {
      return `Its name is ${this.names}`; // æ­¤æ—¶çš„ this æŒ‡å‘å½“å‰çš„ pets å¯¹è±¡ï¼Œå¹¶ä¸ä¼šç»§æ‰¿ä¸Šä¸€å±‚çš„å¯¹è±¡
    },
  },
};

pets.func(); // "Its name is èŠ±å·"
pets.child.func(); // "Its name is å“ˆæ‰¹"

const f = pets.func; // æ­¤æ—¶ obj.func() å‡½æ•°è¢«èµ‹äºˆäº†ä¸€ä¸ªå˜é‡ï¼Œåˆ™ this æŒ‡å‘ä¸ºè¯¥å˜é‡ï¼Œä½†è¯¥å˜é‡ä¸ºå…¨å±€å˜é‡ï¼Œå› æ­¤ this æŒ‡å‘ window å¯¹è±¡
const names = 'Dino';
f(); // "Its name is undefined"
```

- å‡½æ•°å†…å¦‚æœå¤šå±‚åµŒå¥—ä½¿ç”¨ this æ—¶ï¼Œåˆ™ å†…å±‚çš„ this ä¸ä¼šæŒ‡å‘ä¸Šå±‚çš„å¯¹è±¡ï¼Œè€ŒæŒ‡å‘ `window` å¯¹è±¡ï¼Œå› æ­¤éœ€è¦é¿å…ä½¿ç”¨å¤šå±‚ this; å¦‚æœé‡åˆ°è¯¥æƒ…å†µï¼Œå¯ä»¥ä½¿ç”¨ **ä¸­é—´å˜é‡** æ¥å›ºå®š this æˆ–è€…æ”¹å˜ this æŒ‡å‘ï¼Œæ¯”å¦‚ä»¥ä¸‹ç¤ºä¾‹;
- ç”±äº **ç®­å¤´å‡½æ•° æ²¡æœ‰è‡ªå·±çš„ this**ï¼Œå› æ­¤ç®­å¤´å‡½æ•°ä¸­çš„ this ä¼šæŒ‡å‘(ç»§æ‰¿)å®ƒçš„ä¸Šä¸€å±‚å¯¹è±¡;

```js title="ä»£ç ç¤ºä¾‹" showLineNumbers
const pets = {
  names: 'èŠ±å·',
  getNames: function () {
    console.log('names: ', this.names); // this æŒ‡å‘ window å¯¹è±¡
  },

  // ä½¿ç”¨åµŒå¥—å‡½æ•°çš„æƒ…å†µ
  func: function () {
    console.log(this); // this æŒ‡å‘ pets å¯¹è±¡

    const that = this; // å®šä¹‰ä¸€ä¸ªä¸­é—´å˜é‡ï¼Œå°† this ä¿å­˜ä½
    // å®šä¹‰ä¸€ä¸ªç«‹å³æ‰§è¡Œå‡½æ•°
    (function () {
      console.log('å†…å±‚ this: ', this); // this æŒ‡å‘ window å¯¹è±¡ï¼Œä¸¥æ ¼æ¨¡å¼ä¸‹ä¸º undefined

      console.log('å†…å±‚ this: ', that); // this æŒ‡å‘ pets å¯¹è±¡
    })();
  },

  // ä½¿ç”¨ç®­å¤´å‡½æ•°çš„æƒ…å†µ
  getFoods: () => {
    console.log('names: ', this.names); // this æŒ‡å‘ä¸Šä¸€å±‚çš„ window å¯¹è±¡
  },
  getNamesResult: function () {
    setTimeout(() => {
      console.log('setTimeout ä¸­çš„ this: ', this); // this æŒ‡å‘ä¸Šä¸€å±‚çš„ pets å¯¹è±¡ï¼ˆè‹¥æ¢æˆæ™®é€šå‡½æ•°ï¼Œåˆ™ this æŒ‡å‘ window å¯¹è±¡ï¼‰
    }, 1000);

    return () => {
      console.log('è¿”å›ç»“æœä¸­çš„ names: ', this.names); // this æŒ‡å‘ä¸Šä¸€å±‚çš„ pets å¯¹è±¡
    };
  },
};

setTimeout(pets.getNames, 2000); // è¿™é‡Œç­‰åŒäºåœ¨ setTimeout ä¸­ï¼Œpets.getNames è¢«èµ‹äºˆäº†ä¸€ä¸ªå˜é‡ï¼Œç„¶åå†æ‰§è¡Œè¯¥å˜é‡

pets.func();

pets.getFoods();

const fun = pets.getNamesResult(); // è¿™ä¸€æ­¥åªä¼šæ‰§è¡Œ getNamesResult() å‡½æ•°å†…çš„ä»£ç 
fun(); // è¿™ä¸€æ­¥æ‰ä¼šæ‰§è¡Œ getNamesResult() å‡½æ•°å†… return ä¸­çš„ä»£ç 
```

:::caution ç¦»ç¦»åŸä¸Šè°±

- å½“ this æŒ‡å‘ `window` å¯¹è±¡æ—¶ï¼Œå¯¹äº `const` / `let` å®šä¹‰çš„å…¨å±€å˜é‡ï¼Œå› ä¸ºå®ƒä»¬æ˜¯ **å—çº§ä½œç”¨åŸŸ**ï¼Œä¸ä¼šæŒ‚è½½åœ¨ `window` ä¸­ï¼Œå› æ­¤ä¸èƒ½è¢« this è·å–åˆ°; è€Œ `var` æ˜¯å¯ä»¥çš„;

:::

#### æ”¹å˜ this æŒ‡å‘çš„æ–¹å¼

JavaScript æä¾›äº† `call`ã€`apply`ã€`bind` è¿™ä¸‰ç§å‡½æ•°ç‰¹æœ‰çš„æ–¹æ³•æ¥æ‰‹åŠ¨æ”¹å˜ this çš„æŒ‡å‘ï¼Œè®© this å¯ä»¥æŒ‡å‘æ›´æ˜ç¡®çš„å¯¹è±¡ï¼Œå®ƒä»¬çš„ä½œç”¨éƒ½æ˜¯ä¸€æ ·çš„ï¼Œåªæ˜¯å†™æ³•ä¸åŒ;

##### Function.prototype.call()

- è¯­æ³• & å‚æ•°:

```js
Function.prototype.call(thisArg, params1, params2, ...);

// thisArg: è¡¨ç¤º this è¦æŒ‡å‘å“ªä¸ªå¯¹è±¡;
// params1: è¡¨ç¤ºä¼ é€’è‹¥å¹²ä¸ªé¢å¤–å‚æ•°;
```

- å½“ç¬¬ä¸€ä¸ªå‚æ•°ä¸º `null` æˆ– `undefined` æ—¶ï¼Œthis æŒ‡å‘ `window` å¯¹è±¡;
- è¯¥å‡½æ•°æ‰§è¡Œåï¼Œä¼šè¿”å› **åŸå‡½æ•°å†…çš„è¿”å›å€¼**;

##### Function.prototype.apply()

- è¯­æ³• & å‚æ•°:

```js
Function.prototype.apply(thisArg, [params1, params2, ...]);

// thisArg: è¡¨ç¤º this è¦æŒ‡å‘å“ªä¸ªå¯¹è±¡;
// [params1]: è¡¨ç¤ºä¼ é€’ç”± è‹¥å¹²ä¸ªé¢å¤–å‚æ•° ç»„æˆçš„æ•°ç»„é›†åˆ; ğŸ“¢ å¹¶ä¸è¡¨ç¤ºè¯¥å‚æ•°ä¸ºæ•°ç»„ç±»å‹ï¼Œå®é™…ä¸Šè¿˜æ˜¯ç­‰åŒäº function(thisArg, params1, params2, ...);
```

- å®ƒå’Œ `call` çš„ä½œç”¨å®Œå…¨ä¸€è‡´ï¼Œå”¯ä¸€ä¸åŒç‚¹å°±åœ¨äº **ä¼ å‚çš„æ–¹å¼ä¸åŒ**;

##### Function.prototype.bind()

- è¯­æ³• & å‚æ•°:

```js
Function.prototype.bind(thisArg, params1, params2, ...);

// thisArg: è¡¨ç¤º this è¦æŒ‡å‘å“ªä¸ªå¯¹è±¡;
// params1: è¡¨ç¤ºä¼ é€’è‹¥å¹²ä¸ªé¢å¤–å‚æ•°;
```

- è¯¥å‡½æ•°æ‰§è¡Œåï¼Œä¼šè¿”å› **ä¸€ä¸ªæ–°çš„å‡½æ•°**ï¼Œä¹Ÿå°±æ˜¯ **åŸå‡½æ•°çš„æ‹·è´**ï¼Œå¹¶ä¿å­˜äº†å…¶å‚æ•°;

##### callã€apply å’Œ bind çš„ä½¿ç”¨ç¤ºä¾‹

```js title="ä»£ç ç¤ºä¾‹" showLineNumbers
// æƒ³è®© pets.func ä¸­çš„ this æŒ‡å‘ foods å¯¹è±¡
const foods = { names: 'ğŸ‹' };

const pets = {
  names: 'èŠ±å·',
  func: function (str, str_1) {
    console.log('str: ', str); // 'Go!'
    console.log('str_1: ', str_1); // 'Sit Down!'
    console.log(this.names); // 'ğŸ‹'
  },
};

// ä½¿ç”¨ call
pets.func.call(foods, 'Go!', 'Sit Down!'); // å°† this çš„æŒ‡å‘ç”±åŸæ¥çš„ pets å¯¹è±¡æ”¹å˜ä¸º foods å¯¹è±¡

// ä½¿ç”¨ apply
pets.func.apply(foods, ['Go!', 'Sit Down!']);

// ä½¿ç”¨ bind
const fn = pets.func.bind(foods, 'Go!', 'Sit Down!'); // bind æ–¹æ³•ä¸ä¼šç«‹å³æ‰§è¡Œï¼Œæ‰€ä»¥éœ€è¦å°†å…¶èµ‹äºˆä¸€ä¸ªå˜é‡ æˆ–è€… å¤šè°ƒç”¨ä¸€æ¬¡
fn();
```

##### callã€apply å’Œ bind çš„éƒ¨åˆ†åŒºåˆ«

|                            | `call`                    | `apply`                   | `bind`                                |
| -------------------------- | ------------------------- | ------------------------- | ------------------------------------- |
| **æ‰§è¡Œå‡½æ•°çš„æ—¶æœº**         | ç«‹å³æ‰§è¡Œ                  | ç«‹å³æ‰§è¡Œ                  | ä¸æ‰§è¡Œ                                |
| **æ‰§è¡Œå‡½æ•°åï¼Œè¿”å›çš„ç»“æœ** | è¿”å› **åŸå‡½æ•°å†…çš„è¿”å›å€¼** | è¿”å› **åŸå‡½æ•°å†…çš„è¿”å›å€¼** | è¿”å› **åŸå‡½æ•°çš„æ‹·è´**ï¼Œå¹¶ä¿å­˜äº†å…¶å‚æ•° |

##### call å’Œ apply çš„éƒ¨åˆ†ä½¿ç”¨åœºæ™¯

- è·å–æ•°ç»„ä¸­çš„æœ€å¤§å€¼ / æœ€å°å€¼;

```js
const array = [1, 5, 10];

// è·å–æœ€å¤§å€¼
Math.max.apply(null, array); // 10ï¼Œç­‰åŒäº Math.max(1, 5, 10)
// æˆ–
Math.max(...array);

// è·å–æœ€å°å€¼
Math.min.apply(null, array); // 1
// æˆ–
Math.min(...array);
```

- å°†ç±»æ•°ç»„å¯¹è±¡è½¬æ¢æˆçœŸæ­£çš„æ•°ç»„;

```js
Array.prototype.slice.apply({ 0: 1, 1: 'Dino', length: 2 }); // [1, "Dino"]
```

:::tip å‚è€ƒèµ„æ–™

- ğŸ‘‰ [this å…³é”®å­— - ç½‘é“æ–‡æ¡£](https://wangdoc.com/javascript/oop/this.html)
- ğŸ‘‰ [js åŸºç¡€-é¢è¯•å®˜æƒ³çŸ¥é“ä½ æœ‰å¤šç†è§£ call,apply,bindï¼Ÿ - æ˜é‡‘](https://juejin.cn/post/6844903906279964686)

:::

## é—­åŒ…

##### ä»€ä¹ˆæ˜¯é—­åŒ…?

- é—­åŒ…æ˜¯ä¸€ç§å‡½æ•°çš„ **è¡¨ç°æ–¹å¼**ï¼Œå¯ç®€å•è§£é‡Šä¸ºå½“ **ä¸€ä¸ªå‡½æ•°å†…éƒ¨ èƒ½å¤Ÿè®¿é—®åˆ° å¦ä¸€ä¸ªå‡½æ•°ä½œç”¨åŸŸä¸­çš„å˜é‡æˆ–æ–¹æ³•**ï¼Œè¿™æ ·çš„å†™æ³•å³ä¸ºé—­åŒ…;
- ä¹Ÿå¯ä»¥æŠŠé—­åŒ…æ¯”å–»æˆä¸€ä¸ª "èƒŒåŒ…"ï¼Œå½“ä¸€ä¸ªå‡½æ•° **è¢«åˆ›å»ºå¹¶è¢«èµ‹äºˆäº†ä¸€ä¸ªå˜é‡** æˆ– **è¢«å¦ä¸€ä¸ªå‡½æ•°ä½œä¸ºè¿”å›å€¼** æ—¶ï¼Œè¯¥å‡½æ•°éƒ½ä¼šæºå¸¦ä¸€ä¸ª "èƒŒåŒ…"ï¼Œ"èƒŒåŒ…" ä¸­å­˜æ”¾çš„æ˜¯ **å‡½æ•°å£°æ˜æ—¶ä½œç”¨åŸŸå†…æ‰€æœ‰çš„å˜é‡æˆ–æ–¹æ³•**;

##### é—­åŒ…æ˜¯å¦‚ä½•å½¢æˆçš„?

- é—­åŒ…çš„å½¢æˆç®€å•æ¥è¯´æ˜¯ **å†…éƒ¨ä½œç”¨åŸŸ(å‡½æ•°) å­˜åœ¨å¯¹ å¤–éƒ¨ä½œç”¨åŸŸ çš„å¼•ç”¨**ï¼Œå°±ä¼šå¯¼è‡´é—­åŒ…ï¼Œæ¯”å¦‚ ä¸Šçº§ä½œç”¨åŸŸå†…çš„å˜é‡æˆ–æ–¹æ³• è¢« ä¸‹çº§ä½œç”¨åŸŸ(å‡½æ•°)æ‰€å¼•ç”¨ï¼Œè€Œå¯¼è‡´å…¶æœªè¢«é‡Šæ”¾(ä¸ä¼šè¢«åƒåœ¾å›æ”¶æœºåˆ¶å›æ”¶)ï¼Œ**ä¼šå°†å˜é‡å­˜åˆ° å †å†…å­˜ ä¸­**ï¼Œåªèƒ½ç­‰åˆ°ä¸‹çº§ä½œç”¨åŸŸæ‰§è¡Œå®Œä¹‹åæ‰å¾—ä»¥è¢«é‡Šæ”¾;

```js title="ä»£ç ç¤ºä¾‹ - ä¸€ä¸ªç®€å•çš„é—­åŒ…" showLineNumbers
function createCounter() {
  let counter = 0;

  const myFunction = function () {
    counter = counter + 1; // å¼•ç”¨äº† å¤–éƒ¨ä½œç”¨åŸŸ ä¸­çš„å˜é‡ counterï¼Œå¯¼è‡´è¯¥å˜é‡ä¸€ç›´æœªè¢«é‡Šæ”¾ï¼Œæ‰€ä»¥åœ¨æ¯æ¬¡è°ƒç”¨å®ƒæ—¶ï¼Œè¯¥å€¼ä¼šé€’å¢
    return counter;
  };
  return myFunction; // è¿”å›ä¸€ä¸ªå‡½æ•°
}
const increment = createCounter();

const c1 = increment(); // 1
const c2 = increment(); // 2
const c3 = increment(); // 3
```

##### é—­åŒ…çš„ä½œç”¨ & ç‰¹ç‚¹

- ä¿æŠ¤å‡½æ•°ä¸­çš„ **ç§æœ‰å˜é‡ / æ–¹æ³•**ï¼Œä½¿å…¶ä¸å—å¤–éƒ¨å¹²æ‰°æˆ–å›æ”¶ï¼Œé¿å…å…¨å±€æ±¡æŸ“;
- å¯ä»¥æ¨¡ä»¿å—çº§ä½œç”¨åŸŸï¼Œå®ç° JS çš„æ¨¡å—åŒ–;
- é—­åŒ…å‡½æ•°ä¸­çš„ this ä¾ç„¶æŒ‡å‘ `window` å¯¹è±¡;

##### é—­åŒ…çš„ç¼ºç‚¹

- é—­åŒ…ä¸­çš„å˜é‡ / æ–¹æ³•ä¼šå¸¸é©»å†…å­˜ï¼Œä»è€Œå¢å¤§å†…å­˜ä½¿ç”¨é‡ï¼Œè¿‡åº¦ä½¿ç”¨ä¼šå®¹æ˜“é€ æˆå†…å­˜æ³„æ¼;

##### é—­åŒ…å¸¸è§çš„ä½¿ç”¨åœºæ™¯

```js title="åœºæ™¯å£¹ - è‡ªæ‰§è¡Œå‡½æ•°ï¼ˆIIFEï¼‰" showLineNumbers
// ç®€å•çš„ è‡ªæ‰§è¡Œå‡½æ•°
const names = 'èŠ±å·';
(function () {
  console.log(names);
})();

// React ä¸­é€šè¿‡ useEffect è‡ªæ‰§è¡Œå¼‚æ­¥æ–¹æ³•
useEffect(() => {
  (async function () {
    await fetch('/api/...');
  })();
}, []);
```

```js title="åœºæ™¯è´° - å‡½æ•°ä¸­ return ä¸€ä¸ªå‡½æ•°" showLineNumbers
function func() {
  let num = 20;
  // è°ƒç”¨ addTo() æ—¶ï¼Œå®ƒå°±æ˜¯é—­åŒ…å‡½æ•°ï¼Œå­˜åœ¨ä¸Šçº§ä½œç”¨åŸŸçš„å¼•ç”¨
  return function addTo(val) {
    num += val; // ç­‰åŒäº num = num + val
    return num;
  };
}
const f = func();

const c1 = f(5); // 25
const c2 = f(4); // 29
```

```js title="åœºæ™¯å - å‡½æ•°ä½œä¸º å‚æ•° ä¼ é€’" showLineNumbers
function fn() {
  const names = 'èŠ±å·';
  return function getNames() {
    return names;
  };
}

function fn2(f) {
  console.log(f()); // 'èŠ±å·'ï¼Œå®é™…ä¸Šæ˜¯æ‰§è¡Œ getNames å‡½æ•°
}

fn2(fn()); // å°†æ‰§è¡Œåçš„ fn å‡½æ•°ä½œä¸ºå‚æ•°ä¼ å…¥
```

```js title="åœºæ™¯è‚† - å¾ªç¯èµ‹å€¼ï¼ˆç»å…¸é¢è¯•é¢˜ï¼‰" showLineNumbers
for (var i = 0; i < 10; i++) {
  setTimeout(function () {
    console.log(i); // è¾“å‡º 10 ä¸ª 10
  }, 1000);
}

// ğŸ‹ åŸå› åˆ†æ: å› ä¸º JS æ˜¯å•çº¿ç¨‹æ‰§è¡Œï¼Œé‡åˆ°å¼‚æ­¥ä»£ç ä¸ä¼šå…ˆæ‰§è¡Œï¼Œä¼šç­‰å¾…åŒæ­¥çš„ä»£ç ï¼ˆi++ï¼‰è¿è¡Œå®Œæ‰ä¼šæ‰§è¡Œå¼‚æ­¥çš„ setTimeoutï¼Œæ­¤æ—¶çš„ i = 10ï¼Œæ‰€ä»¥ä¼šè¿ç»­è¾“å‡º 10

// ğŸ‹ è§£å†³æ–¹å¼å£¹: ä½¿ç”¨ let ä»£æ›¿ var
// ğŸ‹ è§£å†³æ–¹å¼è´°: ä½¿ç”¨é—­åŒ…çš„æ–¹å¼è§£å†³ï¼Œåˆ›å»ºè‡ªæ‰§è¡Œå‡½æ•°ï¼Œå°† i ä½œä¸ºå‚æ•°ä¼ å…¥ï¼Œå½¢æˆç§æœ‰ä½œç”¨åŸŸ
for (var i = 0; i < 10; i++) {
  (function (index) {
    setTimeout(function () {
      console.log(index); // ä¾æ¬¡è¾“å‡º 0 - 9
    }, 1000);
  })(i);
}
```

```js title="åœºæ™¯ä¼ - å‡½æ•° æŸ¯é‡ŒåŒ–ï¼ˆå°†ä¸€ä¸ªä½¿ç”¨å¤šä¸ªå‚æ•°çš„å‡½æ•° è½¬æ¢æˆ ä¸€ç³»åˆ—ä½¿ç”¨ä¸€ä¸ªæˆ–å¤šä¸ªå‚æ•°çš„å‡½æ•°ï¼‰" showLineNumbers
function curry(func) {
  return function curried(...args) {
    if (args.length >= func.length) {
      // func.length è¡¨ç¤ºåŸå§‹å‡½æ•°ï¼Œä¹Ÿå°±æ˜¯ function (a, b, c, d, e) {} ä¸­å‚æ•°çš„æ€»ä¸ªæ•°ï¼Œ
      return func.apply(this, args); // ç”±äº this æŒ‡å‘ window å¯¹è±¡ï¼Œæ‰€ä»¥éœ€å°†å‚æ•° func å‡½æ•°æŒ‡å‘ å…¨å±€ä¸­çš„ func å‡½æ•°ï¼Œè¿™æ ·å°±èƒ½é¡ºåˆ©æ‹¿åˆ°è¾“å‡ºç»“æœ
    } else {
      return function (...args2) {
        return curried.apply(this, args.concat(args2)); // é‡æ–°è°ƒç”¨ curried å‡½æ•°ï¼Œå°†æ¯æ¬¡ä¼ å…¥çš„å‚æ•°è¿›è¡Œåˆå¹¶
      };
    }
  };
}

// curry() ç­‰åŒäºè°ƒç”¨ curried()
const func = curry(function (a, b, c, d, e) {
  return a + b + c + d + e;
});

func(1, 2, 3, 4, 5); // 15
func(1, 2)(3, 4, 5); // 15
func(1, 2)(3)(4)(5); // 15
func(1)(2)(3)(4)(5); // 15
```

:::tip å‚è€ƒèµ„æ–™

- ğŸ‘‰ [JS é—­åŒ…ç»å…¸ä½¿ç”¨åœºæ™¯å’Œå«é—­åŒ…å¿…åˆ·é¢˜ - æ˜é‡‘](https://juejin.cn/post/6937469222251560990)
- ğŸ‘‰ [æˆ‘ä»æ¥ä¸ç†è§£ JavaScript é—­åŒ…ï¼Œç›´åˆ°æœ‰äººè¿™æ ·å‘æˆ‘è§£é‡Šå®ƒ - æ˜é‡‘](https://juejin.cn/post/6844903858636849159#heading-5)
- ğŸ‘‰ [æŸ¯é‡ŒåŒ–ï¼ˆCurryingï¼‰- JavaScript.Info æ•™ç¨‹](https://zh.javascript.info/currying-partials)

:::

## JS äº‹ä»¶å¾ªç¯æœºåˆ¶ ğŸ“¦

### ä»»åŠ¡é˜Ÿåˆ—

- ç”±äº JavaScript æ˜¯ **å•çº¿ç¨‹è¯­è¨€**ï¼Œå°±æ„å‘³ç€æ‰€æœ‰ä»»åŠ¡éƒ½éœ€è¦æ’é˜Ÿï¼Œå‰ä¸€ä¸ªä»»åŠ¡ç»“æŸï¼Œæ‰ä¼šæ‰§è¡Œä¸‹ä¸€ä¸ªä»»åŠ¡ï¼Œå¦‚æœé‡åˆ°è€—æ—¶æ¯”è¾ƒé•¿çš„ä»»åŠ¡ï¼Œå°±ä¼šé€ æˆé˜»å¡ï¼Œæˆ–è€…å¯¼è‡´ CPU å¤„äºç©ºé—²çŠ¶æ€ï¼Œè¿™æ ·æ•ˆç‡ä¼šå¾ˆä½;
- æ‰€æœ‰è¢«æ‰§è¡Œçš„ä»»åŠ¡è¢«åˆ†ä¸ºä¸¤ç§ï¼Œ**åŒæ­¥ä»»åŠ¡** å’Œ **å¼‚æ­¥ä»»åŠ¡**;

##### åŒæ­¥ä»»åŠ¡

- åœ¨ä¸»çº¿ç¨‹ä¸­æ’é˜Ÿç­‰å¾…æ‰§è¡Œçš„ä»»åŠ¡ï¼Œå‰ä¸€ä¸ªä»»åŠ¡æ‰§è¡Œå®Œæˆï¼Œåä¸€ä¸ªä»»åŠ¡æ‰èƒ½å¼€å§‹æ‰§è¡Œï¼Œå› æ­¤å½¢æˆäº†ä¸€ä¸ª **æ‰§è¡Œæ ˆ**(é˜Ÿåˆ—);
- ä¸»çº¿ç¨‹ä¼šä¸æ–­ **å¾ªç¯**ï¼Œä»æ‰§è¡Œæ ˆä¸­è¯»å–ã€æ‰§è¡Œä»»åŠ¡ï¼Œä¼šæ‰§è¡Œå®Œæ‰€æœ‰æ ˆä¸­çš„åŒæ­¥ä»»åŠ¡;

##### å¼‚æ­¥ä»»åŠ¡

- å½“é‡åˆ°å¼‚æ­¥ä»»åŠ¡æ—¶ï¼Œå¹¶ä¸ä¼šä¸€ç›´ç­‰å¾…å…¶ä»»åŠ¡ç»“æŸï¼Œè€Œæ˜¯ä¼šå°†è¯¥ä»»åŠ¡æ”¾ç½®åœ¨ä¸€ä¸ªä¸æ‰§è¡Œæ ˆä¸åŒçš„é˜Ÿåˆ—ä¸­ï¼Œç§°ä¹‹ä¸º **ä»»åŠ¡(äº‹ä»¶)é˜Ÿåˆ—**ï¼Œéµå¾ª **å…ˆè¿›å…ˆå‡º** çš„åŸåˆ™ï¼Œç„¶åä¸»çº¿ç¨‹åˆ™ç»§ç»­è·‘æ‰§è¡Œæ ˆä¸­çš„å…¶ä»–ä»»åŠ¡;
- å½“ä¸»çº¿ç¨‹å°† **æ‰§è¡Œæ ˆ** ä¸­çš„æ‰€æœ‰åŒæ­¥ä»»åŠ¡è·‘å®Œä¹‹åï¼Œå°±ä¼šè¯»å– **ä»»åŠ¡(äº‹ä»¶)é˜Ÿåˆ—**ï¼ŒæŸ¥çœ‹æœ‰å“ªäº›å¼‚æ­¥ä»»åŠ¡ï¼Œç„¶åå°†å·²ç»æ‰§è¡Œå®Œæˆçš„ä»»åŠ¡å–å‡ºï¼Œå°†è¯¥ä»»åŠ¡çš„å›è°ƒæ”¾å…¥æ‰§è¡Œæ ˆä¸­ï¼Œæ‰§è¡Œå…¶ä¸­çš„åŒæ­¥ä»£ç ;

:::caution æ€»ç»“ - ä»»åŠ¡æ‰§è¡Œæœºåˆ¶

- ç”±äºä¸»çº¿ç¨‹ä» **ä»»åŠ¡(äº‹ä»¶)é˜Ÿåˆ—** ä¸­è¯»å–ä»»åŠ¡çš„è¿‡ç¨‹æ˜¯ **ä¸æ–­å¾ªç¯** çš„ï¼Œæ‰€ä»¥æ•´ä¸ªæµç¨‹çš„è¿è¡Œæœºåˆ¶åˆç§°ä¸º **Event Loopï¼ˆäº‹ä»¶å¾ªç¯ï¼‰**;
- å¯ä»¥ä½¿ç”¨ [_loupe_](http://latentflip.com/loupe) å¯è§†åŒ–å·¥å…·æ¥äº†è§£ JavaScript çš„æ‰§è¡Œæœºåˆ¶;

<Image
  src={require('@site/static/image/column-js/2402010291-b9a57af85eebdab7.png').default}
  width='90%'
  style={{ maxHeight: 380 }}
/>

:::

### å®ä»»åŠ¡ & å¾®ä»»åŠ¡

- ä¸åŒçš„ **å¼‚æ­¥ä»»åŠ¡** æœ‰ä¸åŒçš„ä¼˜å…ˆçº§ï¼Œå½“æ”¾ç½®åœ¨ä»»åŠ¡é˜Ÿåˆ—ä¸­æ—¶ï¼Œå°±æ— æ³•å‡†ç¡®åˆ†è¾¨å®ƒä»¬åœ¨é˜Ÿåˆ—ä¸­çš„ä½ç½®ï¼Œå› æ­¤æ ¹æ®å¼‚æ­¥ä»»åŠ¡çš„ç±»å‹å°†å…¶åˆ†ä¸º **å®ä»»åŠ¡** æˆ– **å¾®ä»»åŠ¡**ï¼Œå†ä¾æ¬¡æ”¾å…¥å…¶å¯¹åº”çš„ä»»åŠ¡é˜Ÿåˆ—ä¸­ï¼Œç„¶åç­‰å¾…ä¸»çº¿ç¨‹å°†å®ƒä»¬ä¾æ¬¡å–å‡ºå¹¶æ”¾å…¥æ‰§è¡Œæ ˆ;

##### éƒ¨åˆ† å®ä»»åŠ¡(macrotask)

```js showLineNumbers
script ï¼ˆæ•´ä½“ä»£ç ï¼‰
setTimeout()
setInterval()
UI æ¸²æŸ“ / äº¤äº’äº‹ä»¶
I/O
window.postMessage()  // è·¨æº(çª—å£)é€šä¿¡
setImmediate ï¼ˆNode.js ç¯å¢ƒï¼‰
```

##### éƒ¨åˆ† å¾®ä»»åŠ¡(microtask)

```js showLineNumbers
new Promise().then();
await ...;
MutationObserver(); // ç›‘è§†å¯¹ DOM æ ‘æ‰€åšçš„æ”¹åŠ¨
process.nextTick ï¼ˆNode.jsç¯å¢ƒï¼‰
```

### Event Loop çš„è¿è¡Œæœºåˆ¶

äº‹ä»¶å¾ªç¯æ˜¯å‘ç”Ÿåœ¨ **ä»»åŠ¡é˜Ÿåˆ—** ä¸­çš„ï¼Œå®ƒçš„æ¯ä¸€æ¬¡å¾ªç¯çš„å…³é”®æ­¥éª¤å¦‚ä¸‹:

- é¦–å…ˆè¿›å…¥ **å®ä»»åŠ¡é˜Ÿåˆ—** ä¸­æŸ¥æ‰¾å®ä»»åŠ¡ï¼ˆé€šå¸¸æ˜¯ `script æ•´ä½“`ï¼‰ï¼Œå¦‚æœæœ‰åˆ™æ‰§è¡Œ;
- åœ¨æ‰§è¡Œè¿‡ç¨‹ä¸­ï¼Œå¦‚æœç¢°åˆ° **å¾®ä»»åŠ¡**ï¼Œå°±å°†å…¶æ·»åŠ åˆ° **å¾®ä»»åŠ¡é˜Ÿåˆ—** ä¸­;
- å®ä»»åŠ¡è·‘å®Œä¹‹åï¼Œå°±ä¾æ¬¡æ‰§è¡Œå½“å‰å¾®ä»»åŠ¡é˜Ÿåˆ—ä¸­çš„ä»»åŠ¡ï¼Œå¦‚æœå¾®ä»»åŠ¡ä¸­åˆç”Ÿæˆäº†ä¸€ä¸ªæ–°çš„å¾®ä»»åŠ¡ï¼Œåˆ™ç»§ç»­æ‰§è¡Œï¼Œç›´åˆ°æ‰€æœ‰çš„å¾®ä»»åŠ¡æ‰§è¡Œå®Œæˆ;
- å®ä»»åŠ¡æ‰§è¡Œå®Œæˆä¹‹åï¼Œå¯èƒ½ä¼šè§¦å‘ / æ›´æ–°æµè§ˆå™¨é¡µé¢çš„æ¸²æŸ“;
- å†æ¬¡è¿›å…¥ **å®ä»»åŠ¡é˜Ÿåˆ—** ä¸­æ‰§è¡Œä¸‹ä¸€æ¬¡ å®ä»»åŠ¡;

ç®€å•æ¥è¯´å°±æ˜¯ **æ¯ä¸€æ¬¡ `Event Loop` å¾ªç¯ä¸­**ï¼Œéƒ½ä¼šå¤„ç†ä¸€ä¸ª **å®ä»»åŠ¡**ï¼Œä»¥åŠè¿™æ¬¡å¾ªç¯ä¸­äº§ç”Ÿçš„ **æ‰€æœ‰å¾®ä»»åŠ¡**;

```js title="ä»£ç ç¤ºä¾‹" showLineNumbers
console.log('start');

setTimeout(() => {
  console.log('setTimeout');
}, 0);

new Promise((resolve) => {
  console.log('Promise åŒæ­¥ä»£ç ');
  resolve();
}).then(() => {
  console.log('promise.then');
});

console.log('end');

// è¾“å‡ºé¡ºåº
// 'start'
// 'Promise åŒæ­¥ä»£ç '
// 'end'
// 'promise.then'
// 'setTimeout'
```

:::tip å‚è€ƒèµ„æ–™

- ğŸ‘‰ [JS è¿è¡Œæœºåˆ¶æœ€å…¨é¢çš„ä¸€æ¬¡æ¢³ç† - å¾®ä¿¡](https://mp.weixin.qq.com/s/cqlhO6N8pGCjNkdHNSio4g) <!--æˆ– https://segmentfault.com/a/1190000012925872-->
- ğŸ‘‰ [JavaScript è¿è¡Œæœºåˆ¶è¯¦è§£ï¼šå†è°ˆ Event Loop - é˜®ä¸€å³°çš„ç½‘ç»œæ—¥å¿—](https://www.ruanyifeng.com/blog/2014/10/event-loop.html)
- ğŸ‘‰ [äº‹ä»¶å¾ªç¯ï¼šå¾®ä»»åŠ¡å’Œå®ä»»åŠ¡ - JavaScript.Info æ•™ç¨‹](https://zh.javascript.info/event-loop)
- ğŸ‘‰ [å½»åº•ææ‡‚ JavaScript äº‹ä»¶å¾ªç¯ - æ˜é‡‘](https://juejin.cn/post/6992167223523541023)
- ğŸ‘‰ [JavaScript ä¸­çš„ Event Loopï¼ˆäº‹ä»¶å¾ªç¯ï¼‰æœºåˆ¶ - æ€å¦](https://segmentfault.com/a/1190000022805523)
- ğŸ‘‰ [æ·±å…¥ JavaScript ä¹‹æ‰§è¡Œä¸Šä¸‹æ–‡ä¸æ‰§è¡Œæ ˆ - çŸ¥ä¹](https://zhuanlan.zhihu.com/p/438019987)

:::

<!-- ## JS è®¾è®¡æ¨¡å¼ -->

<!-- æ‰‹å†™ Promise & åŸç† -->
