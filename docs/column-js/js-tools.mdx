---
title: JS å·¥å…·å‡½æ•°ï¼ˆè®°å½•ï¼‰
id: js-tools
sidebar_position: 2
toc_max_heading_level: 4
---

```mdx-code-block
import BrowserWindow from '@site/src/components/BrowserWindow'
```

> æœ¬ç« èŠ‚è®°å½• JavaScript å¯¹ **å­—ç¬¦ä¸² / æµè§ˆå™¨ / æ­£åˆ™æ ¡éªŒ** è¿›è¡Œå¤„ç†çš„ä¸€äº›å·¥å…·å‡½æ•°;

<!--
<img src={require('@site/static/image/Bg/wp11164545-spy-x-family-anya-wallpapers.jpeg').default} />
-->

## å­—ç¬¦ä¸² & æ•°å€¼

### å®ç° ğŸ’° æ ¼å¼åŒ–

å°†ä¸€æ®µæ•°å€¼æ¯éš” **3 ä½** åŠ ä¸€ä¸ªé€—å·;

```jsx title="ä»£ç å®ç° - å£¹ ğŸ¸" showLineNumbers
// åˆ©ç”¨æ­£åˆ™æ¥å¤„ç†
export const _formatCash = (value: string) => {
  if (!value) return null;
  return value.replace(/\B(?=(\d{3})+(?!\d))/g, ','); // \B è¡¨ç¤ºè¯è¾¹ç•Œ
};
```

```jsx title="ä»£ç å®ç° - è´°" showLineNumbers
// å°†å­—ç¬¦ä¸²è½¬æˆæ•°ç»„å†å¤„ç†
export const _formatCash = (value: string) => {
  if (!value) return null;
  return value
    .split('')
    .reverse()
    .reduce((prev, next, index) => {
      console.log('prev: ', prev); // éå†æ¯ä¸ª return å‡ºå»çš„å€¼
      return (index % 3 ? next : `${next},`) + prev;
    });
};
```

ç¤ºä¾‹:

<BrowserWindow>

```jsx live
function ExampleComponent(props) {
  const str = '1234567890';

  const [value, setValue] = useState('');

  return (
    <ResultButton results={value} onClick={() => setValue(_formatCash(str))} openJsonView={false} />
  );
}
```

</BrowserWindow>

### å­—èŠ‚ & å•ä½ ä¹‹é—´çš„è½¬æ¢

##### å­—èŠ‚ â†’ å•ä½

è·å–ä¸€æ®µæ–‡æœ¬å†…å®¹çš„å­—èŠ‚(`bytes`)å¤§å°ï¼Œå¹¶å°†å…¶è½¬æ¢æˆ `KB`ã€`MB` ç­‰å•ä½å¤§å°;

```jsx title="ä»£ç å®ç°" showLineNumbers
export const _bytesToSize = (value: string) => {
  if (!value) return '0.0 B';

  const num = 1024;
  // ä½¿ç”¨ Blob æ„é€ å‡½æ•° è·å–æ–‡æœ¬å†…å®¹çš„ å­—èŠ‚å¤§å°
  const bytes = new Blob([value]).size;

  if (bytes < num) return `${bytes} B`;
  if (bytes < Math.pow(num, 2)) return `${(bytes / num).toFixed(2)} KB`; // Math.pow() æ–¹æ³•è¡¨ç¤ºä¸€ä¸ªæ•°å€¼çš„ n æ¬¡æ–¹
  if (bytes < Math.pow(num, 3)) return `${(bytes / Math.pow(num, 2)).toFixed(2)} MB`; // ä¿ç•™ä¸¤ä½å°æ•°
  if (bytes < Math.pow(num, 4)) return `${(bytes / Math.pow(num, 3)).toFixed(2)} GB`;
};

// è°ƒç”¨
_bytesToSize('å¤©è¡Œå¥ï¼Œå›å­ä»¥è‡ªå¼ºä¸æ¯ï¼›åœ°åŠ¿å¤ï¼Œå›å­ä»¥åšå¾·è½½ç‰©ã€‚');
```

##### å•ä½ â†’ å­—èŠ‚

å°†å¸¦æœ‰å•ä½(`MB`ã€`KB` ç­‰)çš„å­—ç¬¦ä¸²ï¼Œè½¬æ¢æˆå¯¹åº”çš„å­—èŠ‚å¤§å°;

```jsx title="ä»£ç å®ç°" showLineNumbers
export const _sizeToBytes = (size: string) => {
  const num = 1024;

  if (!size) return 0;
  if (size.endsWith('KB')) return +size.replace('KB', '') * Math.pow(num, 1); // String.endsWith() æ–¹æ³•ç”¨æ¥åˆ¤æ–­å­—ç¬¦ä¸²æ˜¯å¦ä»¥æŒ‡å®šçš„å­—ç¬¦ç»“å°¾ï¼ˆåŒºåˆ†å¤§å°å†™ï¼‰
  if (size.endsWith('MB')) return +size.replace('MB', '') * Math.pow(num, 2);
  if (size.endsWith('GB')) return +size.replace('GB', '') * Math.pow(num, 3);
  return +size.replace('B', '');
};
```

:::tip æ‹“å±•é“¾æ¥

- ğŸ‘‰ [åœ¨çº¿å­—èŠ‚è½¬æ¢å·¥å…·](https://tooltt.com/byte-convert/)

:::

### å»é™¤å­—ç¬¦ä¸²ç©ºæ ¼ ğŸ‹

å»é™¤å­—ç¬¦ä¸²ä¸­çš„ç©ºæ ¼ï¼Œå…¶ä¸­ es6 ä¸­æä¾›äº† `trim()` æ–¹æ³•ï¼Œç”¨äºå»é™¤å­—ç¬¦ä¸²ä¸¤è¾¹çš„ç©ºæ ¼;

```js title="ä»£ç å®ç°" showLineNumbers
export const _trim = (str: string) => {
  // 1ï¸âƒ£ å»é™¤æ‰€æœ‰ç©ºæ ¼
  return str.replace(/\s/g, '');

  // 2ï¸âƒ£ å»é™¤å‰åç©ºæ ¼ï¼Œå¯¹ es6 çš„ trim() æ–¹æ³•è¿›è¡Œå‘ä¸‹å…¼å®¹
  return str?.trim ? str.trim() : str.replace(/^\s+|\s+$/g, '');

  // 3ï¸âƒ£ å»é™¤å‰ç©ºæ ¼
  return str.replace(/^\s/g, '');

  // 4ï¸âƒ£ å»é™¤åç©ºæ ¼
  return str.replace(/\s$/g, '');
};
```

### å­—ç¬¦ä¸²è¡¥é½

æ¨¡ä»¿ es6 æä¾›çš„ `padEnd()` æˆ– `padStart()` æ–¹æ³•å¯¹ä¸€ä¸ªå­—ç¬¦ä¸²è¿›è¡Œè¡¥é½ï¼Œä¹Ÿæ˜¯ä¸ºäº†å‘ä¸‹å…¼å®¹;

```js title="ä»£ç å®ç°" showLineNumbers
export const _padEnd = (str: string, len: number, value: string) => {
  if (str.length < len) {
    const diffLen = len - str.length;

    const endVal = Array.from(new Array(diffLen), (item) => value) // å¿«é€Ÿåˆ›å»ºä¸€ä¸ªæ•°ç»„
      .join('')
      .slice(0, diffLen);
    // æˆ–
    // const endVal = [...new Array(diffLen).keys()]
    //   .map((item) => '*')
    //   .join('')
    //   .slice(0, diffLen);

    return str + endVal; // å¦‚æœéœ€è¦å·¦è¡¥é½ï¼Œåªéœ€å¯¹è°ƒä¸€ä¸‹ç›¸åŠ çš„ä½ç½®å³å¯
  }

  return str;
};

// è°ƒç”¨
_padEnd('007', 6, '*'); // '007***'
```

### æ£€ç´¢å­—ç¬¦ä¸²çš„å¼€å¤´ / ç»“å°¾

æ£€ç´¢å­—ç¬¦ä¸²æ˜¯å¦ä»¥æŒ‡å®šçš„å­—ç¬¦å¼€å¤´ / ç»“å°¾ï¼Œæ¨¡ä»¿ es6 çš„ `startsWith()` å’Œ `endsWith()`ï¼Œä¹Ÿæ˜¯ä¸ºäº†å‘ä¸‹å…¼å®¹;

```js title="ä»£ç å®ç° - æ¨¡ä»¿ startsWith" showLineNumbers
export const _startsWith = (str: string, target: string, position?: number) => {
  const { length } = str;
  let pos = !position ? 0 : position;
  if (pos < 0) pos = 0;

  const start = pos;
  pos += target.length;
  return pos >= 0 && str.slice(start, pos) === target;
};

// è°ƒç”¨
_startsWith('abc', 'a'); // true
_startsWith('abc', 'b'); // false
_startsWith('abc', 'b', 1); // true
```

```js title="ä»£ç å®ç° - æ¨¡ä»¿ endsWith" showLineNumbers
export const _endsWith = (str: string, target: string, position?: number) => {
  const { length } = str;
  let pos = position || length;
  if (pos < 0) pos = 0;
  if (pos > length) pos = length;

  const end = pos;
  pos -= target.length;
  return pos >= 0 && str.slice(pos, end) === target;
};

// è°ƒç”¨
_endsWith('abc', 'c'); // true
_endsWith('abc', 'b'); // false
_endsWith('abc', 'b', 2); // true
```

### éšæœºç”Ÿæˆå­—ç¬¦ä¸²

éšæœºç”ŸæˆæŒ‡å®šé•¿åº¦çš„å­—ç¬¦ä¸²;

```js title="ä»£ç å®ç°" showLineNumbers
export const _randomString = (len: number) => {
  const chars = 'ABCDEFGHJKMNPQRSTWXYZabcdefhijkmnprstwxyz1234567890';
  const strLen = chars.length;

  let randomStr = '';
  for (let i = 0; i < len; i++) {
    randomStr += chars.charAt(Math.floor(Math.random() * strLen)); // String.charAt(index) è¿”å›æŒ‡å®šä¸‹æ ‡ä½ç½®çš„å­—ç¬¦
  }

  return randomStr;
};

// è°ƒç”¨
_randomString(12); // 'Rxsc6ZPetNZs'
```

ç¤ºä¾‹:

<BrowserWindow>

```jsx live
function ExampleComponent(props) {
  const [value, setValue] = useState('');

  return (
    <ResultButton
      results={value}
      onClick={() => setValue(_randomString(12))} // éšæœºç”Ÿæˆé•¿åº¦ä¸º 12 çš„å­—ç¬¦ä¸²
      openJsonView={false}
    />
  );
}
```

</BrowserWindow>

### å•è¯é¦–å­—æ¯å¤§å†™

å°†ä¸€ä¸²è‹±æ–‡å•è¯çš„é¦–å­—æ¯å¤§å†™;

```js title="ä»£ç å®ç°" showLineNumbers
export const _capitalize = (str: string) => {
  const [first, ...rest] = str; // å¯¹å­—ç¬¦ä¸²è¿›è¡Œè§£æ„ï¼Œrest çš„å€¼ä¸ºä¸€ä¸ªæ•°ç»„

  return `${first.toUpperCase()}${rest.join('')}`;
};

// è°ƒç”¨
_capitalize('hello'); // 'Hello'
```

### å•è¯å‘½åè½¬é©¼å³°

å°†å¸¦æœ‰ä¸‹åˆ’çº¿æˆ–æ¨ªçº¿çš„å•è¯å‘½åï¼Œè½¬æ¢ä¸ºé©¼å³°å‘½å;

```js title="ä»£ç å®ç°" showLineNumbers
export const _toHump = (str: string) => {
  return str.replace(/\_(\w)/g, (match, letter, index) => {
    // match - è¡¨ç¤ºåŒ¹é…åˆ°çš„å­—ç¬¦ & å…¶åä¸€ä¸ªå­—ç¬¦çš„ç»„åˆ
    // letter - è¡¨ç¤ºåŒ¹é…åˆ°çš„å­—ç¬¦çš„åä¸€ä¸ªå­—ç¬¦
    // index - è¡¨ç¤ºåŒ¹é…åˆ°çš„å­—ç¬¦çš„ä¸‹æ ‡
    return letter ? letter.toUpperCase() : '';
  });
};

// è°ƒç”¨
_toHump('string_to_number'); // stringToNumber
```

### ç”Ÿæˆä¸¤å€¼é—´ éšæœºæ•´æ•°

è·å–ä»»æ„ä¸¤ä¸ªæ•°å€¼(`x <= num <= y`)ä¹‹é—´çš„éšæœºæ•´æ•°;

```js title="ä»£ç å®ç°" showLineNumbers
export const _random = (min: number, max: number) => {
  const minNum = Math.ceil(min); // å‘ä¸Šå–æ•´
  const maxNum = Math.floor(max); // å‘ä¸‹å–æ•´

  return Math.floor(Math.random() * (maxNum - minNum + 1) + minNum);
};
```

### æ•°å€¼ â†’ ä¸­æ–‡å¤§å†™é‡‘é¢

å°†ä¸€ä¸ªæ•°å€¼è½¬æ¢æˆå¤§å†™çš„ä¸­æ–‡ï¼Œå¸¸ç”¨äºå‘ç¥¨ã€æ”¯ç¥¨ä¸­çš„é‡‘é¢æ˜¾ç¤º;

```js title="ä»£ç å®ç°" showLineNumbers
export const _digitUppercase = (num: number) => {
  const fraction = ['è§’', 'åˆ†'];
  const digit = ['é›¶', 'å£¹', 'è´°', 'å', 'è‚†', 'ä¼', 'é™†', 'æŸ’', 'æŒ', 'ç–'];
  const unit = [
    ['å…ƒ', 'ä¸‡', 'äº¿'],
    ['', 'æ‹¾', 'ä½°', 'ä»Ÿ'],
  ];
  let money = Math.abs(num);
  let s = '';

  // é€šè¿‡éå† fractionï¼Œæ¥è·å– & å¤„ç† num åçš„å°æ•°ä½æ˜¯å‡ ï¼Œå¹¶è½¬æˆç›¸åº”çš„é‡‘é¢
  for (let i = 0; i < fraction.length; i++) {
    // Math.pow(x, y) è¡¨ç¤º x çš„ y æ¬¡å¹‚(æ–¹)
    s += (digit[Math.floor(money * 10 * Math.pow(10, i)) % 10] + fraction[i]).replace(/é›¶./, ''); // ä½¿ç”¨ replace å°†ä»¥é›¶ä¸ºå¼€å¤´çš„é‡‘é¢æ›¿æ¢æˆç©º
  }

  s = s || 'æ•´';
  money = Math.floor(money); // å–æ•´ï¼Œæˆªå–æ‰å°æ•°ä½

  // åŒé‡éå† unit ä¸­çš„ä¸¤ä¸ªæ•°ç»„ï¼Œæ¥è·å– & å¤„ç†æ•´æ•°ä½ï¼Œå¹¶è½¬æˆå“åº”çš„é‡‘é¢
  for (let i = 0; i < unit[0].length && money > 0; i++) {
    let p = '';
    for (let j = 0; j < unit[1].length && money > 0; j++) {
      p = digit[money % 10] + unit[1][j] + p; // è·å– & å¤„ç†æ•´æ•°çš„æœ€åä¸€ä½ï¼Œå¹¶å’Œä¸Šä¸€ä¸ª p å€¼ç›¸åŠ 
      money = Math.floor(money / 10); // æ¯æ¬¡éƒ½ä»åå¼€å§‹ç¼©å‡ä¸€ä¸ªæ•´æ•°ä½ï¼Œå¦‚ 102 å¤„ç†æˆ 10
    }
    console.log('p: ', p);
    s = p.replace(/(é›¶.)*é›¶$/, '').replace(/^$/, 'é›¶') + unit[0][i] + s; // å°†ç©ºå€¼æ›¿æ¢æˆ 'é›¶'ï¼Œå°†ä»¥ é›¶*é›¶ ä¸ºç»“å°¾çš„å­—ç¬¦æ›¿æ¢æˆç©ºï¼Œå¦‚ 'é›¶æ‹¾é›¶'
  }

  return s
    .replace(/(é›¶.)*é›¶å…ƒ/, 'å…ƒ')
    .replace(/(é›¶.)+/g, 'é›¶')
    .replace(/^æ•´$/, 'é›¶å…ƒæ•´');
};
```

ç¤ºä¾‹:

<BrowserWindow>

```jsx live
function ExampleComponent(props) {
  const num = 53020.45;

  const [value, setValue] = useState('');

  return (
    <ResultButton
      results={value}
      onClick={() => setValue(_digitUppercase(num))}
      openJsonView={false}
    />
  );
}
```

</BrowserWindow>

### å››èˆäº”å…¥åˆ°æŒ‡å®šä½æ•°

å°†ä¸€ä¸ªæ•°å€¼ å››èˆäº”å…¥ åˆ°æŒ‡å®šä½æ•°ï¼Œè¿”å› number ç±»å‹;

```js title="ä»£ç å®ç°" showLineNumbers
export const _round = (num: number, decimals = 0) => {
  // 1ï¸âƒ£ ä½¿ç”¨ Number.toFixed() æ–¹æ³•ï¼Œä½†æ˜¯ä¼šè¿”å›ä¸€ä¸ªå­—ç¬¦ä¸²
  return +num.toFixed(decimals);

  // 2ï¸âƒ£ åˆ©ç”¨ Math.round() æ–¹æ³•
  return +`${Math.round(+`${num}e${decimals}`)}e-${decimals}`;
};
```

## DOM äº¤äº’

### é˜²æŠ– & èŠ‚æµ ğŸ‹

##### é˜²æŠ– å‡½æ•°

- **å®šä¹‰**: å¯¹äºä¸€ä¸ªäº‹ä»¶æ¥è¯´ï¼Œ**åœ¨æŒ‡å®šçš„æ—¶é—´(n ç§’)å†…ï¼Œå¦‚æœé¢‘ç¹çš„è§¦å‘è¯¥äº‹ä»¶ï¼Œåˆ™æ—¶é—´ä¼šé‡æ–°è®¡ç®—ï¼Œä¸”å…¶ç»‘å®šçš„å‡½æ•°ä¸ä¼šæ‰§è¡Œ**; **å¦‚æœåœæ­¢è§¦å‘è¯¥äº‹ä»¶ï¼Œåˆ™åœ¨ n ç§’åï¼Œå…¶ç»‘å®šçš„å‡½æ•°ä¼šåªæ‰§è¡Œä¸€æ¬¡**;
- **ä½¿ç”¨åœºæ™¯**: å¸¸ç”¨äºåœ¨è¾“å…¥æ¡†ä¸­æ‰§è¡Œä¸€äº›å¼‚æ­¥ä»»åŠ¡;

```js title="ä»£ç å®ç° - å£¹" showLineNumbers
// åŸç”Ÿ js å®ç° é˜²æŠ–å‡½æ•°
export const _debounce = (fn, delay = 500) => {
  let timeout = null;
  return (...args) => {
    timeout && clearTimeout(timeout);
    timeout = setTimeout(() => {
      fn.apply(this, args);
    }, delay);
  };
};
```

```js title="ä»£ç å®ç° - è´° ğŸ¸" showLineNumbers
// ä½¿ç”¨ç¬¬ä¸‰æ–¹åº“ lodash ä¸­çš„ debounce() æ–¹æ³•
import { debounce } from 'lodash';

// è¾“å…¥æ¡† change äº‹ä»¶
const onChange = (val) => getName(val);

const getName = debounce((val) => {
  console.log('val: ', val);
}, 500);
```

##### èŠ‚æµ å‡½æ•°

- **å®šä¹‰**: ç›¸æ¯”äºé˜²æŠ–è¦å¥½ç†è§£ä¸€äº›ï¼Œç®€è¨€ä¹‹å°±æ˜¯ **æŒ‡å®šä¸€ä¸ªæ—¶é—´(n ç§’)ï¼Œè‹¥é¢‘ç¹çš„è§¦å‘ä¸€ä¸ªäº‹ä»¶ï¼Œè¯¥äº‹ä»¶å‡½æ•°ä¼šæ¯éš” n ç§’æ‰§è¡Œä¸€æ¬¡**;
- **ä½¿ç”¨åœºæ™¯**: å¸¸ç”¨äºæ»šåŠ¨æ¡æ»šåŠ¨äº‹ä»¶çš„å¤„ç†;

```js title="ä»£ç å®ç° - å£¹" showLineNumbers
// åŸç”Ÿ js å®ç° èŠ‚æµå‡½æ•°
export const _throttle = (fn, delay = 500) => {
  let timeout = null;
  return (...args) => {
    !timeout &&
      (timeout = setTimeout(() => {
        fn.apply(this, args);
        timeout = null;
      }, delay));
  };
};
```

```js title="ä»£ç å®ç° - è´° ğŸ¸" showLineNumbers
// ä½¿ç”¨ç¬¬ä¸‰æ–¹åº“ lodash ä¸­çš„ throttle() æ–¹æ³•
import { throttle } from 'lodash';

// ... ç”¨æ³•åŒ é˜²æŠ–å‡½æ•° ä¸€è‡´
```

### é¢œè‰²è‰²å€¼ & RGB ä¹‹é—´çš„è½¬æ¢

##### åå…­è¿›åˆ¶è‰²å€¼ â†’ RGB è‰²å€¼

```js title="ä»£ç å®ç°" showLineNumbers
export const _colorToRGB = (value: string) => {
  const reg = /^#([0-9a-fA-f]{3}|[0-9a-fA-f]{6})$/; // 16è¿›åˆ¶é¢œè‰²å€¼çš„æ­£åˆ™
  let color = value.toLowerCase(); // æŠŠé¢œè‰²å€¼å˜æˆå°å†™

  if (reg.test(color)) {
    // å¦‚æœåªæœ‰ä¸‰ä½çš„å€¼ï¼Œéœ€å˜æˆå…­ä½ï¼Œå¦‚ï¼š#fff => #ffffff
    if (color.length === 4) color = color.padEnd(7, color.slice(1));

    // å¤„ç†å…­ä½çš„é¢œè‰²å€¼ï¼Œè½¬ä¸ºRGB
    const colorChange = [];
    for (let i = 1; i < 7; i += 2) {
      colorChange.push(parseInt('0x' + color.slice(i, i + 2))); // å°†é¢œè‰²å€¼ä¸‰ç­‰åˆ†ï¼Œä¸ '0x' è¿›è¡Œæ‹¼æ¥ï¼Œåˆ©ç”¨ parseInt() å°†å…¶è½¬æ¢æˆåè¿›åˆ¶çš„å€¼ï¼Œå¦‚ parseInt('0xff') => 255
    }
    return `rgb(${colorChange.join(', ')})`;
  }
  return color;
};

// è°ƒç”¨
_colorToRGB('#60ccc7'); // 'rgb(96, 204, 199)'
```

##### RGB è‰²å€¼ â†’ åå…­è¿›åˆ¶è‰²å€¼

```js title="ä»£ç å®ç°" showLineNumbers
export const _rgbToColor = (value: string) => {
  const reg = /^(rgb|RGB)/;

  if (reg.test(value)) {
    let strHex = '#';
    const colorArr = value.replace(/(?:\(|\)|rgb|RGB)*/g, '').split(','); // æŠŠ RGB çš„ 3ä¸ªæ•°å€¼ å˜æˆæ•°ç»„

    colorArr.forEach((item) => {
      let hex = (+item).toString(16); // è½¬æˆ 16è¿›åˆ¶å€¼
      if (hex === '0') hex += hex;
      strHex += hex;
    });
    return strHex;
  }
  return value;
};

// è°ƒç”¨
_rgbToColor('rgb(96, 204, 199)'); // '#60ccc7'
```

:::caution å¦‚ä½•åˆ¤æ–­ä¸€ä¸ªé¢œè‰²ä¸º æ·±è‰² / æµ…è‰²ï¼ˆæ˜äº®åº¦ï¼‰ï¼Œä»è€Œæ”¹å˜å…¶å‰ç½®è‰²ã€èƒŒæ™¯è‰²ç­‰æ ·å¼

```js title="ä»£ç å®ç°" showLineNumbers
export const _isColorDarkOrLight = (value: string) => {
  // value éœ€æ˜¯ä¸€ä¸ª rgb ç±»å‹çš„è‰²å€¼
  const colorArr = value.replace(/(?:\(|\)|rgb|RGB)*/g, '').split(','); // æŠŠ RGB çš„ 3ä¸ªæ•°å€¼ å˜æˆæ•°ç»„
  const ranges = [0.299, 0.587, 0.114]; // ç»™ rgb ä¸­çš„æ¯ä¸ªå€¼æŒ‡å®šç›¸åº”çš„é˜€å€¼

  // è·å–é¢œè‰²çš„ æ˜äº®åº¦
  const grayLevel = colorArr
    .map((item, index) => ({ num: +item, range: ranges[index] }))
    .reduce((prev, cur) => {
      return prev + cur.num * cur.range;
    }, 0);

  // è‹¥æ˜äº®åº¦ >= 136ï¼ˆå¯è‡ªå®šä¹‰ï¼Œå‚è€ƒç½‘ä¸Šèµ„æ–™ï¼Œå¾ˆå¤šä¸º 192ï¼‰ï¼Œåˆ™ä¸º æµ…è‰²ï¼›åä¹‹ä¸º æ·±è‰²
  if (grayLevel >= 136) return 'light';
  return 'dark';
};

// è°ƒç”¨
_isColorDarkOrLight('rgb(255, 255, 255)'); // 'light'
```

:::

### éšæœºç”Ÿæˆé¢œè‰²è‰²å€¼

éšæœºç”Ÿæˆ **åå…­è¿›åˆ¶** çš„é¢œè‰²è‰²å€¼;

```js title="ä»£ç å®ç°" showLineNumbers
export const _randomColor = () => {
  const color = Math.floor(Math.random() * 0xffffff); // 0x è¡¨ç¤ºåå…­è¿›åˆ¶ï¼Œ0xffffff çš„åè¿›åˆ¶ä¸º 16777215ï¼Œè¯¥éšæœºæ•°è¡¨ç¤ºåœ¨ 0-16777215 ä¹‹é—´è·å–

  // ç”Ÿæˆçš„éšæœºæ•°å†é€šè¿‡ toString() è½¬æ¢æˆåå…­è¿›åˆ¶çš„å€¼
  return `#${color.toString(16).padEnd(6, '0')}`.toUpperCase();
};
```

ç¤ºä¾‹:

<BrowserWindow>

```mdx-code-block
import { Button, Space } from '@arco-design/web-react';
import { _randomColor } from '@site/src/utils/tools-fun';
```

export const ExampleComponent = (props) => {
  const [color, setColor] = React.useState(_randomColor());
  return (
    <>
      <Button type='primary' onClick={() => setColor(_randomColor())}>
        ç‚¹å‡»ç”Ÿæˆé¢œè‰²
      </Button>
      <div
        style={{
          marginTop: 10,
          padding: '0 12px',
          width: 268,
          height: 36,
          borderRadius: 2,
          backgroundColor: 'var(--color-fill-2)',
        }}
      >
        <Space style={{ width: '100%', height: '100%', justifyContent: 'space-between' }}>
          {color}
          <div style={{ width: 60, height: 24, borderRadius: 2, backgroundColor: color }} />
        </Space>
      </div>
    </>
  );
};

<ExampleComponent />

</BrowserWindow>

## æµè§ˆå™¨

### è·å–åœ°å€æ ä¸­çš„å‚æ•° ğŸ‹

è·å–åœ°å€æ ä¸­æ‰€æœ‰çš„å‚æ•°ï¼Œå¹¶ç»„æˆä¸€ä¸ªå¯¹è±¡é›†åˆ;

```js title="ä»£ç å®ç° - å£¹" showLineNumbers
export const _getUrlParams = () => {
  const result = {};
  const url = window.location.search; // è·å–åœ°å€æ å‚æ•°
  const reg = /[?&][^?&]+=[^?&]+/g;
  const arr = url.match(reg) || []; // String.match() æ–¹æ³•ä¼šæ ¹æ®æ­£åˆ™å°†åŒ¹é…åˆ°çš„å­—ç¬¦ä¸²åˆ†å‰²ï¼Œç»„æˆä¸€ä¸ªæ•°ç»„

  if (arr.length > 0) {
    arr.forEach((item) => {
      const value = item.substring(1).split('='); // String.substring(start, end) æ–¹æ³•è¡¨ç¤ºæˆªå– start - end ç´¢å¼•ä½ç½®çš„å­—ç¬¦ï¼Œä¸”ä¸ä¼šæ”¹å˜åŸæ•°æ®;
      result[value[0]] = value[1];
    });
  }
  return result;
};

// è°ƒç”¨ï¼Œä¾‹å¦‚åœ°å€ä¸º https://xxx/xxx?name=dino&age=25
_getUrlParams(); // { name: 'dino', age: '25' }
```

```js title="ä»£ç å®ç° - è´° ğŸ¸" showLineNumbers
// ä½¿ç”¨ query-string æ’ä»¶æ¥è·å–ï¼Œè¯¥æ’ä»¶å¯å°†å­—ç¬¦ä¸²è½¬ä¸ºå¯¹è±¡ï¼Œä¾‹å¦‚åœ°å€ä¸º http://xxx/xxx?name=dino&age=25#token=aaa
import qs from 'query-string';

const url = window.location.href; // åœ°å€
const params = window.location.search; // åœ°å€åçš„å‚æ•°
const hash = window.location.hash; // åœ°å€åçš„ hash å€¼

// è·å–åœ°å€ & å‚æ•°å¯¹è±¡
qs.parseUrl(url); // { url: 'http://xxx/xxx', query: { name: 'dino', age: '25' } }

// è·å–å‚æ•°å¯¹è±¡
qs.parse(params); // { name: 'dino', age: '25' }

// è·å–å‚æ•°å¯¹è±¡ï¼Œå¹¶å°†å…¶ä¸­çš„ number æˆ– boolean ç±»å‹çš„å€¼è¿›è¡Œä¿ç•™ï¼Œä¹Ÿå°±æ˜¯ä¸ä¼šè¢«è½¬æˆ string ç±»å‹
qs.parse(params, { parseNumbers: true, parseBooleans: true }); // { name: 'dino', age: 25 }

// è·å– hash å€¼å¯¹è±¡
qs.parse(hash); // { token: 'aaa' }

const obj = { name: 'dino', age: 25, favorite: null };

// å°†å¯¹è±¡è½¬æˆå­—ç¬¦ä¸²å¹¶æ‹¼æ¥ï¼Œé»˜è®¤ä¼šæ’åº
qs.stringify(obj); // 'age=25&favorite&name=dino'

// å°†å¯¹è±¡è½¬æˆå­—ç¬¦ä¸²ï¼Œå¹¶å§‹ç»ˆè¿‡æ»¤æ‰æ— æ•ˆå€¼ æˆ– ç©ºå€¼
qs.stringify(obj, { skipNull: true, skipEmptyString: true }); // 'age=25&name=dino'
```

:::caution ç¦»ç¦»åŸä¸Šè°±

- åœ¨åœ°å€æ ä¸­ä¼ é€’å‚æ•°æ—¶ï¼Œå¦‚æœé‡åˆ° `{}`ã€`[]`ã€`%` ç­‰ç‰¹æ®Šå­—ç¬¦ï¼Œéœ€è¦ä½¿ç”¨ `encodeURIComponent()` æ–¹æ³•å¯¹å­—ç¬¦ä¸²è¿›è¡Œ **ç¼–ç **; ç›¸åº”çš„ï¼Œä½¿ç”¨ `decodeURIComponent()` å¯¹å­—ç¬¦ä¸²è¿›è¡Œ **è§£ç **;

:::

### è·å–çª—å£çš„é«˜åº¦ & å®½åº¦

åœ¨æ­¤ä¹‹å‰ï¼Œé¦–å…ˆéœ€çŸ¥é“åœ¨ JS ä¸­å¯ä»¥è·å–åˆ°ä¸€ä¸ªå…ƒç´ ï¼ˆä¸åŒ…æ‹¬ `window` å¯¹è±¡ï¼‰çš„å®½åº¦ / é«˜åº¦æœ‰å“ªäº›å±æ€§ï¼Œä»¥åŠå®ƒä»¬çš„åŒºåˆ«æ˜¯ä»€ä¹ˆ?

| é«˜åº¦ å±æ€§      | å®½åº¦ å±æ€§     | æè¿°                                                             |
| -------------- | ------------- | ---------------------------------------------------------------- |
| `clientHeight` | `clientWidth` | è¯¥é«˜åº¦ / å®½åº¦ä¸åŒ…å«å…ƒç´ çš„ **è¾¹æ¡†**                               |
| `offsetHeight` | `offsetWidth` | è¯¥é«˜åº¦ / å®½åº¦åŒ…å«å…ƒç´ çš„ **è¾¹æ¡†**ï¼Œä¹Ÿå°±æ˜¯å…ƒç´ è‡ªèº«çš„é«˜åº¦           |
| `scrollHeight` | `scrollWidth` | è¯¥é«˜åº¦ / å®½åº¦ä¸åŒ…å«å…ƒç´ çš„ **è¾¹æ¡†**ï¼Œä½†æ˜¯åŒ…å«å…ƒç´ å†…æ–‡å­—æº¢å‡ºçš„éƒ¨åˆ† |

##### è·å–çª—å£çš„ é«˜åº¦

```js title="ä»£ç å®ç°" showLineNumbers
export const _getBodyClientHeight = () => {
  // 1ï¸âƒ£ è·å–é«˜åº¦ï¼ˆåŒ…å«æ¨ªå‘æ»šåŠ¨æ¡çš„é«˜åº¦ï¼‰
  return window.innerHeight;

  // 2ï¸âƒ£ è·å–é«˜åº¦ï¼ˆåŒ…å«çª—ä½“ + æ¨ªå‘æ»šåŠ¨æ¡çš„é«˜åº¦ + å·¥å…·æ é«˜åº¦ï¼‰
  return window.outerHeight;

  // 3ï¸âƒ£ è·å–é«˜åº¦ï¼ˆä¸åŒ…å«æ¨ªå‘æ»šåŠ¨æ¡çš„é«˜åº¦ï¼‰ï¼Œå¸¸ç”¨
  return document.body.clientHeight || document.documentElement.clientHeight;
};
```

##### è·å–çª—å£çš„ å®½åº¦

```js title="ä»£ç å®ç°" showLineNumbers
export const _getBodyClientWidth = () => {
  // 1ï¸âƒ£ è·å–å®½åº¦ï¼ˆåŒ…å«ç«–å‘æ»šåŠ¨æ¡çš„å®½åº¦ï¼‰
  return window.innerWidth;

  // 2ï¸âƒ£ è·å–å®½åº¦ï¼ˆåŒ…å«çª—ä½“ + ç«–å‘æ»šåŠ¨æ¡çš„å®½åº¦ + å·¥å…·æ å®½åº¦ï¼‰
  return window.outerWidth;

  // 3ï¸âƒ£ è·å–å®½åº¦ï¼ˆä¸åŒ…å«ç«–å‘æ»šåŠ¨æ¡çš„å®½åº¦ï¼‰ï¼Œå¸¸ç”¨
  // ä¹Ÿå¯ä»¥é€šè¿‡ document.compatMode æ¥åˆ¤æ–­å½“å‰é¡µé¢å¤„äºå“ªç§æ¨¡å¼ï¼ŒåŸºæœ¬éƒ½ä¸º 'CSS1Compat'(æ ‡å‡†æ¨¡å¼)ï¼Œä¼šé‡‡ç”¨ document.documentElement çš„å®½åº¦ï¼›è‹¥å¤„äº 'BackCompat'(æ€ªå¼‚æ¨¡å¼) æ—¶ï¼Œä¸€èˆ¬ä¼šé‡‡ç”¨ document.body çš„å®½åº¦
  return (
    document.documentElement.clientWidth ||
    document.documentElement.offsetWidth ||
    document.body.clientWidth ||
    document.body.offsetWidth
  );
};
```

### æ»šåŠ¨åˆ°æŒ‡å®šä½ç½® ğŸ‹

è®©é¡µé¢çš„æ»šåŠ¨æ¡å¹³æ»‘æ»šåŠ¨åˆ°æŒ‡å®šçš„ä½ç½®ï¼Œæœ€å¸¸è§çš„å°±æ˜¯ **è¿”å›é¡¶éƒ¨** çš„åŠŸèƒ½;

```js title="ä»£ç å®ç° - å£¹" showLineNumbers
// ä½¿ç”¨ window.scrollTo() è¿›è¡Œæ»šåŠ¨ï¼Œå®ƒæœ‰ä¸¤ä¸ªå‚æ•° xpos(æ¨ªåæ ‡) å’Œ ypos(çºµåæ ‡)ï¼Œè¡¨ç¤ºæ»šåŠ¨åˆ°æŒ‡å®šçš„åæ ‡ä½ç½®;

// ä½†æ˜¯å½“ç¬¬ä¸€ä¸ªå‚æ•°ä¸ºå¯¹è±¡æ—¶ï¼Œè¡¨ç¤ºçºµå‘æ»šåŠ¨ï¼Œå®ƒæœ‰ä¸¤ä¸ªå±æ€§ï¼Œå¦‚ä¸‹:
// top - æŒ‡å®šçš„ä½ç½®;
// behavior - æ»šåŠ¨çš„æ•ˆæœï¼Œ'smooth'(å¹³æ»‘æ»šåŠ¨) | 'auto'(ç¬é—´æ»šåŠ¨);

export const _scrollTo = (top: number) => {
  window.scrollTo({ top, behavior: 'smooth' });
};
```

```js title="ä»£ç å®ç° - è´° ğŸ¸" showLineNumbers
// ä½¿ç”¨ window.requestAnimationFrame() è¿›è¡ŒåŠ¨ç”»æ»šåŠ¨ï¼Œå®ƒå¯ä»¥æ›¿ä»£ setInterval å®šæ—¶å™¨ï¼Œå®ç°ä¸€äº›åŠ¨ç”»æ•ˆæœ;
// è¯¥æ–¹æ³•çš„å‚æ•°æ˜¯ä¸€ä¸ªå›è°ƒå‡½æ•°ï¼Œä¼šåœ¨æµè§ˆå™¨ä¸‹ä¸€æ¬¡é‡ç»˜ä¹‹å‰è°ƒç”¨è¯¥å‡½æ•°æ¥æ›´æ–°åŠ¨ç”»ï¼Œå› æ­¤ä¸€æ—¦è°ƒç”¨è¯¥æ–¹æ³•å°±æ— æ³•åœæ­¢;

// è¯¥æ–¹æ³•ä¼šè¿”å›ä¸€ä¸ª number ç±»å‹çš„å€¼ï¼Œè¡¨ç¤ºå”¯ä¸€æ ‡è¯†ï¼Œå¯ä»¥å°†è¿™ä¸ªæ ‡è¯†ä¼ å…¥ window.cancelAnimationFrame() ä¸­ï¼Œæ¥å–æ¶ˆè¯¥æ–¹æ³•çš„è¿è¡Œï¼Œä»¥åœæ­¢åŠ¨ç”»

export const _scrollTo = () => {
  const c = document.documentElement.scrollTop || document.body.scrollTop; // è·å–æ»šåŠ¨æ¡åˆ°é¡µé¢é¡¶éƒ¨çš„è·ç¦»
  if (c > 0) {
    window.requestAnimationFrame(_smoothScroll);
    window.scrollTo(0, c - c / 8); // æ»šåŠ¨åˆ°é¡¶éƒ¨ï¼Œå¯è‡ªå®šä¹‰æ»šåŠ¨çš„é€Ÿåº¦ï¼Œä»¥å®ç°å¹³æ»‘æ»šåŠ¨
  }
};
```

:::tip å‚è€ƒèµ„æ–™

- ğŸ‘‰ [window.requestAnimationFrame å¼ºå¤§çš„å‰ç«¯åŠ¨ç”»ç¥å™¨ - CSDN](https://blog.csdn.net/yun_master/article/details/123110930)

:::

### å…ƒç´ æ»šåŠ¨åˆ°å¯è§†åŒºåŸŸ

å°†æŸä¸ª Dom å…ƒç´ æ»šåŠ¨åˆ°çª—å£çš„å¯è§†åŒºåŸŸï¼Œä¹Ÿå°±æ˜¯æµè§ˆå™¨çª—å£çš„é¡¶éƒ¨ã€ä¸­é—´æˆ–åº•éƒ¨ï¼Œå’Œé¡µé¢ä¸­å¸¸è§çš„é”šç‚¹é“¾æ¥è·³è½¬çš„åŠŸèƒ½æ˜¯ä¸€æ ·çš„;

```js title="ä»£ç å®ç°" showLineNumbers
// ä½¿ç”¨ Element.scrollIntoView() è¿›è¡Œæ»šåŠ¨ï¼Œå®ƒçš„å‚æ•°æ˜¯ä¸€ä¸ª Boolean å€¼æˆ–ä¸€ä¸ªå¯¹è±¡;

// å½“å‚æ•°ä¸º Boolean å€¼æ—¶ï¼Œtrue - è¡¨ç¤ºå°†å…ƒç´ çš„é¡¶éƒ¨ä¸å¯è§†åŒºåŸŸçš„é¡¶éƒ¨å¯¹é½; false - è¡¨ç¤ºå°†å…ƒç´ çš„åº•éƒ¨ä¸å¯è§†åŒºåŸŸçš„åº•éƒ¨å¯¹é½;

// å½“å‚æ•°ä¸ºä¸€ä¸ªå¯¹è±¡æ—¶ï¼Œå®ƒæœ‰å¦‚ä¸‹å±æ€§:
// behavior - æ»šåŠ¨çš„æ•ˆæœï¼Œ'smooth'(å¹³æ»‘æ»šåŠ¨) | 'auto'(ç¬é—´æ»šåŠ¨);
// block - å¯è§†åŒºåŸŸçš„ä½ç½®ï¼Œ'start'(é¡¶éƒ¨) | 'end'(åº•éƒ¨) | 'center'(ä¸­é—´) | 'nearest'(æœ€è¿‘è·ç¦»);

export const _smoothScroll = (element: string, block?: ScrollLogicalPosition = 'end') => {
  document.querySelector(element).scrollIntoView({ behavior: 'smooth', block });
};
```

:::tip å‚è€ƒèµ„æ–™

- ğŸ‘‰ [JS DOM ç¼–ç¨‹ç¬”è®° - scrollIntoView() - çŸ¥ä¹](https://zhuanlan.zhihu.com/p/429549072)

:::

### è¯†åˆ«è¿è¡Œç¯å¢ƒ & ç‰ˆæœ¬

```js title="ä»£ç å®ç°" showLineNumbers
export const _inBrowser = () => {
  // åˆ¤æ–­è¿è¡Œç¯å¢ƒæ˜¯å¦ä¸º æµè§ˆå™¨
  const isBrowser = typeof window !== 'undefined'; // åœ¨æµè§ˆå™¨ç¯å¢ƒä¸­è¿”å› trueï¼Œnode ç¯å¢ƒä¸‹è¿”å› falseï¼ˆå› ä¸º node ç¯å¢ƒä¸­æ²¡æœ‰ windowï¼‰

  // åˆ¤æ–­è¿è¡Œç¯å¢ƒæ˜¯å¦ä¸º å¾®ä¿¡
  // const inWeex = typeof WXEnvironment !== 'undefined' && !!WXEnvironment.platform;
  // const weexPlatform = inWeex && WXEnvironment.platform.toLowerCase();

  if (!isBrowser) return;

  // åˆ¤æ–­æµè§ˆå™¨çš„ç±»å‹å’Œç‰ˆæœ¬
  const UA = window.navigator.userAgent.toLowerCase(); // è·å–æµè§ˆå™¨çš„å‚å•†å’Œç‰ˆæœ¬ä¿¡æ¯

  // const isAndroid = (UA && UA.indexOf('android') > 0) || weexPlatform === 'android'; // æ˜¯å¦ä¸º Android
  // const isIOS = (UA && /iphone|ipad|ipod|ios/.test(UA)) || weexPlatform === 'ios'; // æ˜¯å¦ä¸º Ios
  const isEdge = UA && UA.indexOf('edg') > -1; // æ˜¯å¦ä¸º Edge æµè§ˆå™¨
  const isChrome = UA && /chrome\/\d+/.test(UA) && !isEdge; // æ˜¯å¦ä¸º Chrome æµè§ˆ
  const isOpera = UA && UA.indexOf('opera') > -1; // æ˜¯å¦ä¸º Opera æµè§ˆå™¨
  const isFirefox = UA && UA.indexOf('firefox') > -1; // æ˜¯å¦ä¸º Firefox æµè§ˆå™¨
  const isSafari = UA && UA.indexOf('safari') > -1 && !isChrome && !isEdge; // æ˜¯å¦ä¸º Safari æµè§ˆå™¨

  // å¯¹ IE æµè§ˆå™¨å•ç‹¬è¿›è¡Œåˆ¤æ–­
  const isIE = UA && /msie|trident/.test(UA); // æ˜¯å¦ä¸º IE æµè§ˆå™¨
  const isIE11 = UA && isIE && UA.indexOf('rv:11.0') > -1; // æ˜¯å¦ä¸º IE11 æµè§ˆå™¨
  const isIE_else = UA && isIE && !isIE11; // æ˜¯å¦ä¸º IE å…¶ä»–ç‰ˆæœ¬æµè§ˆå™¨

  // åˆ¤æ–­ IE < 11 æµè§ˆå™¨çš„ç‰ˆæœ¬
  if (isIE_else) {
    const reIE = new RegExp('msie (\\d+\\.\\d+);');
    reIE.test(UA);
    const fIEVersion = parseFloat(RegExp['$1']); // è·å– IE æµè§ˆå™¨çš„ç‰ˆæœ¬
  }
};
```
